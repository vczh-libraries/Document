<!DOCTYPE html>
<html>
<head>
    <title>VlppOS.h</title>
    <link rel="stylesheet" href="../Cpp.css" />
    <link rel="shortcut icon" href="../favicon.ico" />
    <script type="text/javascript" src="../Cpp.js" ></script>
</head>
<body>
<a class="button" href="./FileIndex.html">File Index</a>
<a class="button" href="./SymbolIndex.html">Symbol Index</a>
<br>
<br>
<div class="codebox"><div class="cpp_default"><div class="token cpp_comment ">/***********************************************************************
THIS FILE IS AUTOMATICALLY GENERATED. DO NOT MODIFY
DEVELOPER: Zihan Chen(vczh)
***********************************************************************/</div>
<div class="disabled">#include &quot;Vlpp.h&quot;</div>

<div class="token cpp_comment ">/***********************************************************************
.\HTTPUTILITY.H
***********************************************************************/</div>
<div class="disabled">#ifndef VCZH_HTTPUTILITY</div>
<div class="disabled">#define VCZH_HTTPUTILITY</div>


<div class="disabled">#ifdef VCZH_MSVC</div>

<div class="disabled">namespace vl</div>
<div class="disabled">{</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">HTTP Utility</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">	/// &lt;summary&gt;A type representing an http requiest.&lt;/summary&gt;</div>
<div class="disabled">	class HttpRequest</div>
<div class="disabled">	{</div>
<div class="disabled">		typedef collections::Array&lt;char&gt;					BodyBuffer;</div>
<div class="disabled">		typedef collections::List&lt;WString&gt;					StringList;</div>
<div class="disabled">		typedef collections::Dictionary&lt;WString, WString&gt;	HeaderMap;</div>
<div class="disabled">	public:</div>
<div class="disabled">		/// &lt;summary&gt;Name of the server, like &quot;gaclib.net&quot;.&lt;/summary&gt;</div>
<div class="disabled">		WString				server;</div>
<div class="disabled">		/// &lt;summary&gt;Port of the server, like 80.&lt;/summary&gt;</div>
<div class="disabled">		vint				port;</div>
<div class="disabled">		/// &lt;summary&gt;Query of the request, like &quot;/GettingStart.html&quot;.&lt;/summary&gt;</div>
<div class="disabled">		WString				query;</div>
<div class="disabled">		/// &lt;summary&gt;Set to true if the request uses SSL.&lt;/summary&gt;</div>
<div class="disabled">		bool				secure;</div>
<div class="disabled">		/// &lt;summary&gt;User name to authorize. Set to empty if you don&apos;t want to provide it.&lt;/summary&gt;</div>
<div class="disabled">		WString				username;</div>
<div class="disabled">		/// &lt;summary&gt;Password to authorize. Set to empty if you don&apos;t want to provide it.&lt;/summary&gt;</div>
<div class="disabled">		WString				password;</div>
<div class="disabled">		/// &lt;summary&gt;HTTP method, like &quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;, etc.&lt;/summary&gt;</div>
<div class="disabled">		WString				method;</div>
<div class="disabled">		/// &lt;summary&gt;Cookie. Set to empty if you don&apos;t want to provide it.&lt;/summary&gt;</div>
<div class="disabled">		WString				cookie;</div>
<div class="disabled">		/// &lt;summary&gt;Request body. This is a binary array using an array container to char.&lt;/summary&gt;</div>
<div class="disabled">		BodyBuffer			body;</div>
<div class="disabled">		/// &lt;summary&gt;Content type, like &quot;text/xml&quot;.&lt;/summary&gt;</div>
<div class="disabled">		WString				contentType;</div>
<div class="disabled">		/// &lt;summary&gt;Accept type list, elements of it like &quot;text/xml&quot;.&lt;/summary&gt;</div>
<div class="disabled">		StringList			acceptTypes;</div>
<div class="disabled">		/// &lt;summary&gt;A dictionary to contain extra headers.&lt;/summary&gt;</div>
<div class="disabled">		HeaderMap			extraHeaders;</div>

<div class="disabled">		/// &lt;summary&gt;Create an empty request.&lt;/summary&gt;</div>
<div class="disabled">		HttpRequest();</div>

<div class="disabled">		/// &lt;summary&gt;Set &lt;see cref=&quot;server&quot;/&gt;, &lt;see cref=&quot;port&quot;/&gt;, &lt;see cref=&quot;query&quot;/&gt; and &lt;see cref=&quot;secure&quot;/&gt; fields for you using an URL.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;inputQuery&quot;&gt;The URL.&lt;/param&gt;</div>
<div class="disabled">		bool				SetHost(const WString&amp; inputQuery);</div>

<div class="disabled">		/// &lt;summary&gt;Fill the body with a text using UTF-8 encoding.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;bodyString&quot;&gt;The text to fill.&lt;/param&gt;</div>
<div class="disabled">		void				SetBodyUtf8(const WString&amp; bodyString);</div>
<div class="disabled">	};</div>
<div class="disabled">	</div>
<div class="disabled">	/// &lt;summary&gt;A type representing an http response.&lt;/summary&gt;</div>
<div class="disabled">	class HttpResponse</div>
<div class="disabled">	{</div>
<div class="disabled">		typedef collections::Array&lt;char&gt;		BodyBuffer;</div>
<div class="disabled">	public:</div>
<div class="disabled">		/// &lt;summary&gt;Status code, like 200.&lt;/summary&gt;</div>
<div class="disabled">		vint				statusCode;</div>
<div class="disabled">		/// &lt;summary&gt;Response body. This is a binary array using an array container to char.&lt;/summary&gt;</div>
<div class="disabled">		BodyBuffer			body;</div>
<div class="disabled">		/// &lt;summary&gt;Returned cookie from the server.&lt;/summary&gt;</div>
<div class="disabled">		WString				cookie;</div>

<div class="disabled">		HttpResponse();</div>

<div class="disabled">		/// &lt;summary&gt;If you believe the server returns a text in UTF-8, use it to decode the body.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The response body as text.&lt;/returns&gt;</div>
<div class="disabled">		WString				GetBodyUtf8();</div>
<div class="disabled">	};</div>

<div class="disabled">	/// &lt;summary&gt;Send an http request and receive a response.&lt;/summary&gt;</div>
<div class="disabled">	/// &lt;returns&gt;Returns true if this operation succeeded. Even the server returns 404 will be treated as success, because you get the response.&lt;/returns&gt;</div>
<div class="disabled">	/// &lt;param name=&quot;request&quot;&gt;The request.&lt;/param&gt;</div>
<div class="disabled">	/// &lt;param name=&quot;response&quot;&gt;The response.&lt;/param&gt;</div>
<div class="disabled">	extern bool				HttpQuery(const HttpRequest&amp; request, HttpResponse&amp; response);</div>

<div class="disabled">	/// &lt;summary&gt;Encode a text as part of the url. This function can be used to create arguments in an URL.&lt;/summary&gt;</div>
<div class="disabled">	/// &lt;returns&gt;The encoded text.&lt;/returns&gt;</div>
<div class="disabled">	/// &lt;param name=&quot;query&quot;&gt;The text to encode.&lt;/param&gt;</div>
<div class="disabled">	extern WString			UrlEncodeQuery(const WString&amp; query);</div>
<div class="disabled">}</div>

<div class="disabled">#endif</div>

<div class="disabled">#endif</div>


<div class="token cpp_comment ">/***********************************************************************
.\LOCALE.H
***********************************************************************/</div>
<div class="token cpp_comment ">/***********************************************************************
Vczh Library++ 3.0
Developer: Zihan Chen(vczh)
Framework::Locale

Interfaces:
***********************************************************************/</div>

<div class="disabled">#ifndef VCZH_LOCALE</div>
<div class="disabled">#define VCZH_LOCALE</div>


<div class="disabled">namespace vl</div>
<div class="disabled">{</div>
<div class="disabled">	/// &lt;summary&gt;Locale awared operations. Macro &quot;INVLOC&quot; is a shortcut to get a invariant locale.&lt;/summary&gt;</div>
<div class="disabled">	class Locale : public Object</div>
<div class="disabled">	{</div>
<div class="disabled">	protected:</div>
<div class="disabled">		WString						localeName;</div>

<div class="disabled">	public:</div>
<div class="disabled">		Locale(const WString&amp; _localeName=WString::Empty);</div>
<div class="disabled">		~Locale();</div>

<div class="disabled">		bool operator==(const Locale&amp; value)const { return localeName==value.localeName; }</div>
<div class="disabled">		bool operator!=(const Locale&amp; value)const { return localeName!=value.localeName; }</div>
<div class="disabled">		bool operator&lt;(const Locale&amp; value)const { return localeName&lt;value.localeName; }</div>
<div class="disabled">		bool operator&lt;=(const Locale&amp; value)const { return localeName&lt;=value.localeName; }</div>
<div class="disabled">		bool operator&gt;(const Locale&amp; value)const { return localeName&gt;value.localeName; }</div>
<div class="disabled">		bool operator&gt;=(const Locale&amp; value)const { return localeName&gt;=value.localeName; }</div>

<div class="disabled">		/// &lt;summary&gt;Get the invariant locale.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The invariant locale.&lt;/returns&gt;</div>
<div class="disabled">		static Locale				Invariant();</div>
<div class="disabled">		/// &lt;summary&gt;Get the system default locale. This locale controls the code page that used by the the system to interpret ANSI string buffers.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The system default locale.&lt;/returns&gt;</div>
<div class="disabled">		static Locale				SystemDefault();</div>
<div class="disabled">		/// &lt;summary&gt;Get the user default locale. This locale reflect the user&apos;s setting.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The user default locale.&lt;/returns&gt;</div>
<div class="disabled">		static Locale				UserDefault();</div>
<div class="disabled">		/// &lt;summary&gt;Get all supported locales.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;locales&quot;&gt;All supported locales.&lt;/param&gt;</div>
<div class="disabled">		static void					Enumerate(collections::List&lt;Locale&gt;&amp; locales);</div>

<div class="disabled">		/// &lt;summary&gt;Get the name of the locale.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The name of the locale.&lt;/returns&gt;</div>
<div class="disabled">		const WString&amp;				GetName()const;</div>

<div class="disabled">		/// &lt;summary&gt;Get all short date formats for the locale.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;formats&quot;&gt;The formats.&lt;/param&gt;</div>
<div class="disabled">		void						GetShortDateFormats(collections::List&lt;WString&gt;&amp; formats)const;</div>
<div class="disabled">		/// &lt;summary&gt;Get all long date formats for the locale.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;formats&quot;&gt;The formats.&lt;/param&gt;</div>
<div class="disabled">		void						GetLongDateFormats(collections::List&lt;WString&gt;&amp; formats)const;</div>
<div class="disabled">		/// &lt;summary&gt;Get all Year-Month date formats for the locale.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;formats&quot;&gt;The formats.&lt;/param&gt;</div>
<div class="disabled">		void						GetYearMonthDateFormats(collections::List&lt;WString&gt;&amp; formats)const;</div>
<div class="disabled">		/// &lt;summary&gt;Get all long time formats for the locale.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;formats&quot;&gt;The formats.&lt;/param&gt;</div>
<div class="disabled">		void						GetLongTimeFormats(collections::List&lt;WString&gt;&amp; formats)const;</div>
<div class="disabled">		/// &lt;summary&gt;Get all short time formats for the locale.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;formats&quot;&gt;The formats.&lt;/param&gt;</div>
<div class="disabled">		void						GetShortTimeFormats(collections::List&lt;WString&gt;&amp; formats)const;</div>

<div class="disabled">		/// &lt;summary&gt;Convert a date to a formatted string.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The formatted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;format&quot;&gt;The format to use.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;date&quot;&gt;The date to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						FormatDate(const WString&amp; format, DateTime date)const;</div>
<div class="disabled">		/// &lt;summary&gt;Convert a time to a formatted string.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The formatted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;format&quot;&gt;The format to use.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;time&quot;&gt;The time to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						FormatTime(const WString&amp; format, DateTime time)const;</div>

<div class="disabled">		/// &lt;summary&gt;Convert a number to a formatted string.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The formatted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;number&quot;&gt;The number to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						FormatNumber(const WString&amp; number)const;</div>
<div class="disabled">		/// &lt;summary&gt;Convert a currency (money) to a formatted string.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The formatted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;currency&quot;&gt;The currency to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						FormatCurrency(const WString&amp; currency)const;</div>

<div class="disabled">		/// &lt;summary&gt;Get the short display string of a day of week.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The display string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;dayOfWeek&quot;&gt;Day of week, begins from 0 as Sunday.&lt;/param&gt;</div>
<div class="disabled">		WString						GetShortDayOfWeekName(vint dayOfWeek)const;</div>
<div class="disabled">		/// &lt;summary&gt;Get the long display string of a day of week.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The display string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;dayOfWeek&quot;&gt;Day of week, begins from 0 as Sunday.&lt;/param&gt;</div>
<div class="disabled">		WString						GetLongDayOfWeekName(vint dayOfWeek)const;</div>
<div class="disabled">		/// &lt;summary&gt;Get the short display string of a month.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The display string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;month&quot;&gt;Month, begins from 1 as January.&lt;/param&gt;</div>
<div class="disabled">		WString						GetShortMonthName(vint month)const;</div>
<div class="disabled">		/// &lt;summary&gt;Get the long display string of a month.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The display string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;month&quot;&gt;Month, begins from 1 as January.&lt;/param&gt;</div>
<div class="disabled">		WString						GetLongMonthName(vint month)const;</div>
<div class="disabled">		</div>
<div class="disabled">#ifdef VCZH_MSVC</div>
<div class="disabled">		/// &lt;summary&gt;Convert characters to the full width.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The converted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;str&quot;&gt;The string to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						ToFullWidth(const WString&amp; str)const;</div>
<div class="disabled">		/// &lt;summary&gt;Convert characters to the half width.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The converted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;str&quot;&gt;The string to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						ToHalfWidth(const WString&amp; str)const;</div>
<div class="disabled">		/// &lt;summary&gt;Convert characters to the Hiragana.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The converted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;str&quot;&gt;The string to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						ToHiragana(const WString&amp; str)const;</div>
<div class="disabled">		/// &lt;summary&gt;Convert characters to the Katagana.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The converted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;str&quot;&gt;The string to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						ToKatagana(const WString&amp; str)const;</div>
<div class="disabled">#endif</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Convert characters to the lower case using the file system rule.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The converted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;str&quot;&gt;The string to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						ToLower(const WString&amp; str)const;</div>
<div class="disabled">		/// &lt;summary&gt;Convert characters to the upper case using the file system rule.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The converted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;str&quot;&gt;The string to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						ToUpper(const WString&amp; str)const;</div>
<div class="disabled">		/// &lt;summary&gt;Convert characters to the lower case using the linguistic rule.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The converted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;str&quot;&gt;The string to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						ToLinguisticLower(const WString&amp; str)const;</div>
<div class="disabled">		/// &lt;summary&gt;Convert characters to the upper case using the linguistic rule.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The converted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;str&quot;&gt;The string to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						ToLinguisticUpper(const WString&amp; str)const;</div>

<div class="disabled">#ifdef VCZH_MSVC</div>
<div class="disabled">		/// &lt;summary&gt;Convert characters to Simplified Chinese.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The converted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;str&quot;&gt;The string to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						ToSimplifiedChinese(const WString&amp; str)const;</div>
<div class="disabled">		/// &lt;summary&gt;Convert characters to the Traditional Chinese.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The converted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;str&quot;&gt;The string to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						ToTraditionalChinese(const WString&amp; str)const;</div>
<div class="disabled">		/// &lt;summary&gt;Convert characters to the tile case, in which the first letter of each major word is capitalized.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The converted string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;str&quot;&gt;The string to convert.&lt;/param&gt;</div>
<div class="disabled">		WString						ToTileCase(const WString&amp; str)const;</div>
<div class="disabled">#endif</div>

<div class="disabled">		/// &lt;summary&gt;Mergable flags controlling how to normalize a string.&lt;/summary&gt;</div>
<div class="disabled">		enum Normalization</div>
<div class="disabled">		{</div>
<div class="disabled">			/// &lt;summary&gt;Do nothing.&lt;/summary&gt;</div>
<div class="disabled">			None=0,</div>
<div class="disabled">			/// &lt;summary&gt;Ignore case using the file system rule.&lt;/summary&gt;</div>
<div class="disabled">			IgnoreCase=1,</div>
<div class="disabled">#ifdef VCZH_MSVC</div>
<div class="disabled">			/// &lt;summary&gt;Ignore case using the linguistic rule.&lt;/summary&gt;</div>
<div class="disabled">			IgnoreCaseLinguistic=2,</div>
<div class="disabled">			/// &lt;summary&gt;Ignore the difference between between hiragana and katakana characters.&lt;/summary&gt;</div>
<div class="disabled">			IgnoreKanaType=4,</div>
<div class="disabled">			/// &lt;summary&gt;Ignore nonspacing characters.&lt;/summary&gt;</div>
<div class="disabled">			IgnoreNonSpace=8,</div>
<div class="disabled">			/// &lt;summary&gt;Ignore symbols and punctuation.&lt;/summary&gt;</div>
<div class="disabled">			IgnoreSymbol=16,</div>
<div class="disabled">			/// &lt;summary&gt;Ignore the difference between half-width and full-width characters.&lt;/summary&gt;</div>
<div class="disabled">			IgnoreWidth=32,</div>
<div class="disabled">			/// &lt;summary&gt;Treat digits as numbers during sorting.&lt;/summary&gt;</div>
<div class="disabled">			DigitsAsNumbers=64,</div>
<div class="disabled">			/// &lt;summary&gt;Treat punctuation the same as symbols.&lt;/summary&gt;</div>
<div class="disabled">			StringSoft=128,</div>
<div class="disabled">#endif</div>
<div class="disabled">		};</div>

<div class="disabled">		/// &lt;summary&gt;Compare two strings.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns 0 if two strings are equal. Returns a positive number if the first string is larger. Returns a negative number if the second string is larger. When sorting strings, larger strings are put after then smaller strings.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;s1&quot;&gt;The first string to compare.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;s2&quot;&gt;The second string to compare.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;normalization&quot;&gt;Flags controlling how to normalize a string.&lt;/param&gt;</div>
<div class="disabled">		vint									Compare(const WString&amp; s1, const WString&amp; s2, Normalization normalization)const;</div>
<div class="disabled">		/// &lt;summary&gt;Compare two strings to test binary equivalence.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns 0 if two strings are equal. Returns a positive number if the first string is larger. Returns a negative number if the second string is larger. When sorting strings, larger strings are put after then smaller strings.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;s1&quot;&gt;The first string to compare.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;s2&quot;&gt;The second string to compare.&lt;/param&gt;</div>
<div class="disabled">		vint									CompareOrdinal(const WString&amp; s1, const WString&amp; s2)const;</div>
<div class="disabled">		/// &lt;summary&gt;Compare two strings to test binary equivalence, ignoring case.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns 0 if two strings are equal. Returns a positive number if the first string is larger. Returns a negative number if the second string is larger. When sorting strings, larger strings are put after then smaller strings.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;s1&quot;&gt;The first string to compare.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;s2&quot;&gt;The second string to compare.&lt;/param&gt;</div>
<div class="disabled">		vint									CompareOrdinalIgnoreCase(const WString&amp; s1, const WString&amp; s2)const;</div>
<div class="disabled">		/// &lt;summary&gt;Find the first position that the sub string appears in a text.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns a pair of numbers, the first number indicating the position in the text, the second number indicating the size of the equivalence sub string in the text. For some normalization, the found sub string may be binary different to the string you want to find.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;text&quot;&gt;The text to find the sub string.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;find&quot;&gt;The sub string to match.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;normalization&quot;&gt;Flags controlling how to normalize a string.&lt;/param&gt;</div>
<div class="disabled">		collections::Pair&lt;vint, vint&gt;			FindFirst(const WString&amp; text, const WString&amp; find, Normalization normalization)const;</div>
<div class="disabled">		/// &lt;summary&gt;Find the last position that the sub string appears in a text.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns a pair of numbers, the first number indicating the position in the text, the second number indicating the size of the equivalence sub string in the text. For some normalization, the found sub string may be binary different to the string you want to find.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;text&quot;&gt;The text to find the sub string.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;find&quot;&gt;The sub string to match.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;normalization&quot;&gt;Flags controlling how to normalize a string.&lt;/param&gt;</div>
<div class="disabled">		collections::Pair&lt;vint, vint&gt;			FindLast(const WString&amp; text, const WString&amp; find, Normalization normalization)const;</div>
<div class="disabled">		/// &lt;summary&gt;Test is the prefix of the text equivalence to the provided sub string.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if the prefix of the text equivalence to the provided sub string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;text&quot;&gt;The text to test the prefix.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;find&quot;&gt;The sub string to match.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;normalization&quot;&gt;Flags controlling how to normalize a string.&lt;/param&gt;</div>
<div class="disabled">		bool									StartsWith(const WString&amp; text, const WString&amp; find, Normalization normalization)const;</div>
<div class="disabled">		/// &lt;summary&gt;Test is the postfix of the text equivalence to the provided sub string.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if the postfix of the text equivalence to the provided sub string.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;text&quot;&gt;The text to test the postfix.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;find&quot;&gt;The sub string to match.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;normalization&quot;&gt;Flags controlling how to normalize a string.&lt;/param&gt;</div>
<div class="disabled">		bool									EndsWith(const WString&amp; text, const WString&amp; find, Normalization normalization)const;</div>
<div class="disabled">	};</div>

<div class="disabled">#define INVLOC vl::Locale::Invariant()</div>
<div class="disabled">}</div>

<div class="disabled">#endif</div>

<div class="token cpp_comment ">/***********************************************************************
.\THREADING.H
***********************************************************************/</div>
<div class="token cpp_comment ">/***********************************************************************
Vczh Library++ 3.0
Developer: Zihan Chen(vczh)
Framework::Threading

Classes:
	Thread										: Thread
	CriticalSection
	Mutex
	Semaphore
	EventObject
***********************************************************************/</div>

<div class="disabled">#ifndef VCZH_THREADING</div>
<div class="disabled">#define VCZH_THREADING</div>


<div class="disabled">namespace vl</div>
<div class="disabled">{</div>
<div class="disabled">	</div>
<div class="disabled">/***********************************************************************</div>
<div class="disabled">Kernel Mode Objects</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">	namespace threading_internal</div>
<div class="disabled">	{</div>
<div class="disabled">		struct WaitableData;</div>
<div class="disabled">		struct ThreadData;</div>
<div class="disabled">		struct MutexData;</div>
<div class="disabled">		struct SemaphoreData;</div>
<div class="disabled">		struct EventData;</div>
<div class="disabled">		struct CriticalSectionData;</div>
<div class="disabled">		struct ReaderWriterLockData;</div>
<div class="disabled">		struct ConditionVariableData;</div>
<div class="disabled">	}</div>
<div class="disabled">	</div>
<div class="disabled">	/// &lt;summary&gt;Base type of all synchronization objects.&lt;/summary&gt;</div>
<div class="disabled">	class WaitableObject : public Object, public NotCopyable</div>
<div class="disabled">	{</div>
<div class="disabled">#if defined VCZH_MSVC</div>
<div class="disabled">	private:</div>
<div class="disabled">		threading_internal::WaitableData*			waitableData;</div>
<div class="disabled">	protected:</div>

<div class="disabled">		WaitableObject();</div>
<div class="disabled">		void										SetData(threading_internal::WaitableData* data);</div>
<div class="disabled">	public:</div>
<div class="disabled">		/// &lt;summary&gt;Test if the object has already been created. Some of the synchronization objects should initialize itself after the constructor. This function is only available in Windows.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if the object has already been created.&lt;/returns&gt;</div>
<div class="disabled">		bool										IsCreated();</div>
<div class="disabled">		/// &lt;summary&gt;Wait for this object to signal.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if the object is signaled. Returns false if this operation failed.&lt;/returns&gt;</div>
<div class="disabled">		bool										Wait();</div>
<div class="disabled">		/// &lt;summary&gt;Wait for this object to signal for a period of time. This function is only available in Windows.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if the object is signaled. Returns false if this operation failed, including time out.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;ms&quot;&gt;Time in milliseconds.&lt;/param&gt;</div>
<div class="disabled">		bool										WaitForTime(vint ms);</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Wait for multiple objects. This function is only available in Windows.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if all objects are signaled. Returns false if this operation failed.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;objects&quot;&gt;A pointer to an array to &lt;see cref=&quot;WaitableObject&quot;/&gt; pointers.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;count&quot;&gt;The number of &lt;see cref=&quot;WaitableObject&quot;/&gt; objects in the array.&lt;/param&gt;</div>
<div class="disabled">		static bool									WaitAll(WaitableObject** objects, vint count);</div>
<div class="disabled">		/// &lt;summary&gt;Wait for multiple objects for a period of time. This function is only available in Windows.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if all objects are signaled. Returns false if this operation failed, including time out.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;objects&quot;&gt;A pointer to an array to &lt;see cref=&quot;WaitableObject&quot;/&gt; pointers.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;count&quot;&gt;The number of &lt;see cref=&quot;WaitableObject&quot;/&gt; objects in the array.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;ms&quot;&gt;Time in milliseconds.&lt;/param&gt;</div>
<div class="disabled">		static bool									WaitAllForTime(WaitableObject** objects, vint count, vint ms);</div>
<div class="disabled">		/// &lt;summary&gt;Wait for one of the objects. This function is only available in Windows.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns the index of the first signaled or abandoned object, according to the &quot;abandoned&quot; parameter. Returns -1 if this operation failed.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;objects&quot;&gt;A pointer to an array to &lt;see cref=&quot;WaitableObject&quot;/&gt; pointers.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;count&quot;&gt;The number of &lt;see cref=&quot;WaitableObject&quot;/&gt; objects in the array.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;abandoned&quot;&gt;Returns true if the waiting is canceled by an abandoned object. An abandoned object is caused by it&apos;s owner thread existing without releasing it.&lt;/param&gt;</div>
<div class="disabled">		static vint									WaitAny(WaitableObject** objects, vint count, bool* abandoned);</div>
<div class="disabled">		/// &lt;summary&gt;Wait for one of the objects for a period of time. This function is only available in Windows.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns the index of the first signaled or abandoned object, according to the &quot;abandoned&quot; parameter. Returns -1 if this operation failed, including time out.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;objects&quot;&gt;A pointer to an array to &lt;see cref=&quot;WaitableObject&quot;/&gt; pointers.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;count&quot;&gt;The number of &lt;see cref=&quot;WaitableObject&quot;/&gt; objects in the array.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;ms&quot;&gt;Time in milliseconds.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;abandoned&quot;&gt;Returns true if the waiting is canceled by an abandoned object. An abandoned object is caused by it&apos;s owner thread existing without releasing it.&lt;/param&gt;</div>
<div class="disabled">		static vint									WaitAnyForTime(WaitableObject** objects, vint count, vint ms, bool* abandoned);</div>
<div class="disabled">#elif defined VCZH_GCC</div>
<div class="disabled">		virtual bool								Wait() = 0;</div>
<div class="disabled">#endif</div>
<div class="disabled">	};</div>

<div class="disabled">	/// &lt;summary&gt;Representing a thread. [M:vl.Thread.CreateAndStart] is the suggested way to create threads.&lt;/summary&gt;</div>
<div class="disabled">	class Thread : public WaitableObject</div>
<div class="disabled">	{</div>
<div class="disabled">		friend void InternalThreadProc(Thread* thread);</div>
<div class="disabled">	public:</div>
<div class="disabled">		/// &lt;summary&gt;Thread state.&lt;/summary&gt;</div>
<div class="disabled">		enum ThreadState</div>
<div class="disabled">		{</div>
<div class="disabled">			/// &lt;summary&gt;The thread has not started.&lt;/summary&gt;</div>
<div class="disabled">			NotStarted,</div>
<div class="disabled">			/// &lt;summary&gt;The thread is running.&lt;/summary&gt;</div>
<div class="disabled">			Running,</div>
<div class="disabled">			/// &lt;summary&gt;The thread has been stopped.&lt;/summary&gt;</div>
<div class="disabled">			Stopped</div>
<div class="disabled">		};</div>

<div class="disabled">		typedef void(*ThreadProcedure)(Thread*, void*);</div>
<div class="disabled">	protected:</div>
<div class="disabled">		threading_internal::ThreadData*				internalData;</div>
<div class="disabled">		volatile ThreadState						threadState;</div>

<div class="disabled">		virtual void								Run()=0;</div>

<div class="disabled">		Thread();</div>
<div class="disabled">	public:</div>
<div class="disabled">		~Thread();</div>

<div class="disabled">		/// &lt;summary&gt;Create a thread using a function pointer.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns the created thread.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;procedure&quot;&gt;The function pointer.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;argument&quot;&gt;The argument to call the function pointer.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;deleteAfterStopped&quot;&gt;Set to true (by default) to make the thread delete itself after the job is done. If you set this argument to true, you are not suggested to touch the returned thread pointer in any way.&lt;/param&gt;</div>
<div class="disabled">		static Thread*								CreateAndStart(ThreadProcedure procedure, void* argument=0, bool deleteAfterStopped=true);</div>
<div class="disabled">		/// &lt;summary&gt;Create a thread using a function object or a lambda expression.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns the created thread.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;procedure&quot;&gt;The function object or the lambda expression.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;deleteAfterStopped&quot;&gt;Set to true (by default) to make the thread delete itself after the job is done. If you set this argument to true, you are not suggested to touch the returned thread pointer in any way.&lt;/param&gt;</div>
<div class="disabled">		static Thread*								CreateAndStart(const Func&lt;void()&gt;&amp; procedure, bool deleteAfterStopped=true);</div>
<div class="disabled">		/// &lt;summary&gt;Pause the caller thread for a period of time.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;ms&quot;&gt;Time in milliseconds.&lt;/param&gt;</div>
<div class="disabled">		static void									Sleep(vint ms);</div>
<div class="disabled">		/// &lt;summary&gt;Get the number of logical processors.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The number of logical processor.&lt;/returns&gt;</div>
<div class="disabled">		static vint									GetCPUCount();</div>
<div class="disabled">		/// &lt;summary&gt;Get the current thread id.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The current thread id.&lt;/returns&gt;</div>
<div class="disabled">		static vint									GetCurrentThreadId();</div>

<div class="disabled">		/// &lt;summary&gt;Start the thread.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		bool										Start();</div>
<div class="disabled">#if defined VCZH_GCC</div>
<div class="disabled">		bool										Wait();</div>
<div class="disabled">#endif</div>
<div class="disabled">		/// &lt;summary&gt;Stop the thread.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		bool										Stop();</div>
<div class="disabled">		/// &lt;summary&gt;Get the state of the thread.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The state of the thread.&lt;/returns&gt;</div>
<div class="disabled">		ThreadState									GetState();</div>
<div class="disabled">#ifdef VCZH_MSVC</div>
<div class="disabled">		void										SetCPU(vint index);</div>
<div class="disabled">#endif</div>
<div class="disabled">	};</div>

<div class="disabled">	/// &lt;summary&gt;Mutex.&lt;/summary&gt;</div>
<div class="disabled">	class Mutex : public WaitableObject</div>
<div class="disabled">	{</div>
<div class="disabled">	private:</div>
<div class="disabled">		threading_internal::MutexData*				internalData;</div>
<div class="disabled">	public:</div>
<div class="disabled">		Mutex();</div>
<div class="disabled">		~Mutex();</div>

<div class="disabled">		/// &lt;summary&gt;Create a mutex.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;owned&quot;&gt;Set to true to own the created mutex.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;name&quot;&gt;Name of the mutex. If it is not empty, than it is a global named mutex. This argument is ignored in Linux.&lt;/param&gt;</div>
<div class="disabled">		bool										Create(bool owned=false, const WString&amp; name=L&quot;&quot;);</div>
<div class="disabled">		/// &lt;summary&gt;Open an existing global named mutex.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;inheritable&quot;&gt;Set to true make the mutex visible to all all child processes. This argument is only used in Windows.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;name&quot;&gt;Name of the mutex. This argument is ignored in Linux.&lt;/param&gt;</div>
<div class="disabled">		bool										Open(bool inheritable, const WString&amp; name);</div>

<div class="disabled">		/// &lt;summary&gt;</div>
<div class="disabled">		/// Release the mutex.</div>
<div class="disabled">		/// In the implementation for Linux, calling Release() more than once between two Wait(), or calling Wait() more than once between two Release(), will results in an undefined behavior.</div>
<div class="disabled">		/// &lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		bool										Release();</div>
<div class="disabled">#ifdef VCZH_GCC</div>
<div class="disabled">		bool										Wait();</div>
<div class="disabled">#endif</div>
<div class="disabled">	};</div>
<div class="disabled">	</div>
<div class="disabled">	/// &lt;summary&gt;Semaphore.&lt;/summary&gt;</div>
<div class="disabled">	class Semaphore : public WaitableObject</div>
<div class="disabled">	{</div>
<div class="disabled">	private:</div>
<div class="disabled">		threading_internal::SemaphoreData*			internalData;</div>
<div class="disabled">	public:</div>
<div class="disabled">		Semaphore();</div>
<div class="disabled">		~Semaphore();</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Create a semaphore.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;initialCount&quot;&gt;Define the counter of the semaphore.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;maxCount&quot;&gt;Define the maximum value of the counter of the semaphore. This argument is only used in Windows.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;name&quot;&gt;Name of the semaphore. If it is not empty, than it is a global named semaphore. This argument is ignored in Linux.&lt;/param&gt;</div>
<div class="disabled">		bool										Create(vint initialCount, vint maxCount, const WString&amp; name=L&quot;&quot;);</div>
<div class="disabled">		/// &lt;summary&gt;Open an existing global named semaphore.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;inheritable&quot;&gt;Set to true make the semaphore visible to all all child processes. This argument is only used in Windows.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;name&quot;&gt;Name of the semaphore. This argument is ignored in Linux.&lt;/param&gt;</div>
<div class="disabled">		bool										Open(bool inheritable, const WString&amp; name);</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt; Release the semaphore once. &lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		bool										Release();</div>
<div class="disabled">		/// &lt;summary&gt; Release the semaphore multiple times. &lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;count&quot;&gt;The amout to release.&lt;/param&gt;</div>
<div class="disabled">		vint										Release(vint count);</div>
<div class="disabled">#ifdef VCZH_GCC</div>
<div class="disabled">		bool										Wait();</div>
<div class="disabled">#endif</div>
<div class="disabled">	};</div>

<div class="disabled">	/// &lt;summary&gt;Event.&lt;/summary&gt;</div>
<div class="disabled">	class EventObject : public WaitableObject</div>
<div class="disabled">	{</div>
<div class="disabled">	private:</div>
<div class="disabled">		threading_internal::EventData*				internalData;</div>
<div class="disabled">	public:</div>
<div class="disabled">		EventObject();</div>
<div class="disabled">		~EventObject();</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Create an auto unsignal event. Auto unsignal means, when one thread waits for the event and succeeded, the event will become unsignaled immediately.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;signaled&quot;&gt;Set to true make the event signaled at the beginning.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;name&quot;&gt;Name of the event. If it is not empty, than it is a global named mutex. This argument is only used in Windows.&lt;/param&gt;</div>
<div class="disabled">		bool										CreateAutoUnsignal(bool signaled, const WString&amp; name=L&quot;&quot;);</div>
<div class="disabled">		/// &lt;summary&gt;Create a manual unsignal event.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;signaled&quot;&gt;Set to true make the event signaled at the beginning.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;name&quot;&gt;Name of the event. If it is not empty, than it is a global named mutex. This argument is only used in Windows.&lt;/param&gt;</div>
<div class="disabled">		bool										CreateManualUnsignal(bool signaled, const WString&amp; name=L&quot;&quot;);</div>
<div class="disabled">		/// &lt;summary&gt;Open an existing global named event.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;inheritable&quot;&gt;Set to true make the event visible to all all child processes. This argument is only used in Windows.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;name&quot;&gt;Name of the event. This argument is only used in Windows.&lt;/param&gt;</div>
<div class="disabled">		bool										Open(bool inheritable, const WString&amp; name);</div>

<div class="disabled">		/// &lt;summary&gt;Signal the event.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		bool										Signal();</div>
<div class="disabled">		/// &lt;summary&gt;Unsignal the event.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		bool										Unsignal();</div>
<div class="disabled">#ifdef VCZH_GCC</div>
<div class="disabled">		bool										Wait();</div>
<div class="disabled">#endif</div>
<div class="disabled">	};</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Thread Pool</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">	/// &lt;summary&gt;A light-weight thread pool.&lt;/summary&gt;</div>
<div class="disabled">	class ThreadPoolLite : public Object</div>
<div class="disabled">	{</div>
<div class="disabled">	private:</div>
<div class="disabled">		ThreadPoolLite();</div>
<div class="disabled">		~ThreadPoolLite();</div>
<div class="disabled">	public:</div>
<div class="disabled">		/// &lt;summary&gt;Queue a function pointer.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;proc&quot;&gt;The function pointer.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;argument&quot;&gt;The argument to call the function pointer.&lt;/param&gt;</div>
<div class="disabled">		static bool									Queue(void(*proc)(void*), void* argument);</div>
<div class="disabled">		/// &lt;summary&gt;Queue a function object.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;proc&quot;&gt;The function object.&lt;/param&gt;</div>
<div class="disabled">		static bool									Queue(const Func&lt;void()&gt;&amp; proc);</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Queue a lambda expression.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;typeparam name=&quot;T&quot;&gt;The type of the lambda expression.&lt;/typeparam&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;proc&quot;&gt;The lambda expression.&lt;/param&gt;</div>
<div class="disabled">		template&lt;typename T&gt;</div>
<div class="disabled">		static void QueueLambda(const T&amp; proc)</div>
<div class="disabled">		{</div>
<div class="disabled">			Queue(Func&lt;void()&gt;(proc));</div>
<div class="disabled">		}</div>

<div class="disabled">#ifdef VCZH_GCC</div>
<div class="disabled">		static bool									Stop(bool discardPendingTasks);</div>
<div class="disabled">#endif</div>
<div class="disabled">	};</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Kernel Mode Objects in Process</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">	/// &lt;summary&gt;&lt;![CDATA[</div>
<div class="disabled">	/// Critical section. It is similar to mutex, but in Windows, enter a owned critical section will not cause dead lock.</div>
<div class="disabled">	/// The macro &quot;CS_LOCK&quot; is encouraged to use instead of calling [M:vl.CriticalSection.Enter] and [M:vl.CriticalSection.Leave] like this:</div>
<div class="disabled">	/// CS_LOCK(yourCriticalSection)</div>
<div class="disabled">	/// {</div>
<div class="disabled">	///		&lt;code&gt;</div>
<div class="disabled">	/// }</div>
<div class="disabled">	/// ]]&gt;&lt;/summary&gt;</div>
<div class="disabled">	class CriticalSection : public Object, public NotCopyable</div>
<div class="disabled">	{</div>
<div class="disabled">	private:</div>
<div class="disabled">		friend class ConditionVariable;</div>
<div class="disabled">		threading_internal::CriticalSectionData*	internalData;</div>
<div class="disabled">	public:</div>
<div class="disabled">		/// &lt;summary&gt;Create a critical section.&lt;/summary&gt;</div>
<div class="disabled">		CriticalSection();</div>
<div class="disabled">		~CriticalSection();</div>

<div class="disabled">		/// &lt;summary&gt;Try enter a critical section. This function will return immediately.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if the current thread owned the critical section.&lt;/returns&gt;</div>
<div class="disabled">		bool										TryEnter();</div>
<div class="disabled">		/// &lt;summary&gt;Enter a critical section.&lt;/summary&gt;</div>
<div class="disabled">		void										Enter();</div>
<div class="disabled">		/// &lt;summary&gt;Leave a critical section.&lt;/summary&gt;</div>
<div class="disabled">		void										Leave();</div>

<div class="disabled">	public:</div>
<div class="disabled">		class Scope : public Object, public NotCopyable</div>
<div class="disabled">		{</div>
<div class="disabled">		private:</div>
<div class="disabled">			CriticalSection*						criticalSection;</div>
<div class="disabled">		public:</div>
<div class="disabled">			Scope(CriticalSection&amp; _criticalSection);</div>
<div class="disabled">			~Scope();</div>
<div class="disabled">		};</div>
<div class="disabled">	};</div>
<div class="disabled">	</div>
<div class="disabled">	/// &lt;summary&gt;&lt;![CDATA[</div>
<div class="disabled">	/// Reader writer lock.</div>
<div class="disabled">	/// The macro &quot;READER_LOCK&quot; and &quot;WRITER_LOCK&quot; are encouraged to use instead of calling [M:vl.ReaderWriterLock.EnterReader], [M:vl.ReaderWriterLock.LeaveReader], [M:vl.ReaderWriterLock.EnterWriter] and [M:vl.ReaderWriterLock.LeaveWriter] like this:</div>
<div class="disabled">	/// READER_LOCK(yourLock)</div>
<div class="disabled">	/// {</div>
<div class="disabled">	///		&lt;code&gt;</div>
<div class="disabled">	/// }</div>
<div class="disabled">	/// or</div>
<div class="disabled">	/// WRITER_LOCK(yourLock)</div>
<div class="disabled">	/// {</div>
<div class="disabled">	///		&lt;code&gt;</div>
<div class="disabled">	/// }</div>
<div class="disabled">	/// ]]&gt;&lt;/summary&gt;</div>
<div class="disabled">	class ReaderWriterLock : public Object, public NotCopyable</div>
<div class="disabled">	{</div>
<div class="disabled">	private:</div>
<div class="disabled">		friend class ConditionVariable;</div>
<div class="disabled">		threading_internal::ReaderWriterLockData*	internalData;</div>
<div class="disabled">	public:</div>
<div class="disabled">		/// &lt;summary&gt;Create a reader writer lock.&lt;/summary&gt;</div>
<div class="disabled">		ReaderWriterLock();</div>
<div class="disabled">		~ReaderWriterLock();</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Try acquire a reader lock. This function will return immediately.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if the current thread acquired the reader lock.&lt;/returns&gt;</div>
<div class="disabled">		bool										TryEnterReader();</div>
<div class="disabled">		/// &lt;summary&gt;Acquire a reader lock.&lt;/summary&gt;</div>
<div class="disabled">		void										EnterReader();</div>
<div class="disabled">		/// &lt;summary&gt;Release a reader lock.&lt;/summary&gt;</div>
<div class="disabled">		void										LeaveReader();</div>
<div class="disabled">		/// &lt;summary&gt;Try acquire a writer lock. This function will return immediately.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if the current thread acquired the writer lock.&lt;/returns&gt;</div>
<div class="disabled">		bool										TryEnterWriter();</div>
<div class="disabled">		/// &lt;summary&gt;Acquire a writer lock.&lt;/summary&gt;</div>
<div class="disabled">		void										EnterWriter();</div>
<div class="disabled">		/// &lt;summary&gt;Release a writer lock.&lt;/summary&gt;</div>
<div class="disabled">		void										LeaveWriter();</div>
<div class="disabled">	public:</div>
<div class="disabled">		class ReaderScope : public Object, public NotCopyable</div>
<div class="disabled">		{</div>
<div class="disabled">		private:</div>
<div class="disabled">			ReaderWriterLock*						lock;</div>
<div class="disabled">		public:</div>
<div class="disabled">			ReaderScope(ReaderWriterLock&amp; _lock);</div>
<div class="disabled">			~ReaderScope();</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		class WriterScope : public Object, public NotCopyable</div>
<div class="disabled">		{</div>
<div class="disabled">		private:</div>
<div class="disabled">			ReaderWriterLock*						lock;</div>
<div class="disabled">		public:</div>
<div class="disabled">			WriterScope(ReaderWriterLock&amp; _lock);</div>
<div class="disabled">			~WriterScope();</div>
<div class="disabled">		};</div>
<div class="disabled">	};</div>

<div class="disabled">	/// &lt;summary&gt;Conditional variable.&lt;/summary&gt;</div>
<div class="disabled">	class ConditionVariable : public Object, public NotCopyable</div>
<div class="disabled">	{</div>
<div class="disabled">	private:</div>
<div class="disabled">		threading_internal::ConditionVariableData*	internalData;</div>
<div class="disabled">	public:</div>
<div class="disabled">		/// &lt;summary&gt;Create a conditional variable.&lt;/summary&gt;</div>
<div class="disabled">		ConditionVariable();</div>
<div class="disabled">		~ConditionVariable();</div>

<div class="disabled">		/// &lt;summary&gt;Bind a conditional variable with a owned critical section and release it. When the function returns, the condition variable is activated, and the current thread owned the critical section again.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;cs&quot;&gt;The critical section.&lt;/param&gt;</div>
<div class="disabled">		bool										SleepWith(CriticalSection&amp; cs);</div>
<div class="disabled">#ifdef VCZH_MSVC</div>
<div class="disabled">		/// &lt;summary&gt;Bind a conditional variable with a owned critical section and release it for a period of time. When the function returns, the condition variable is activated or it is time out, and the current thread owned the critical section again. This function is only available in Windows.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;cs&quot;&gt;The critical section.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;ms&quot;&gt;Time in milliseconds.&lt;/param&gt;</div>
<div class="disabled">		bool										SleepWithForTime(CriticalSection&amp; cs, vint ms);</div>
<div class="disabled">		/// &lt;summary&gt;Bind a conditional variable with a owned reader lock and release it. When the function returns, the condition variable is activated, and the current thread owned the reader lock again. This function is only available in Windows.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;lock&quot;&gt;The reader lock.&lt;/param&gt;</div>
<div class="disabled">		bool										SleepWithReader(ReaderWriterLock&amp; lock);</div>
<div class="disabled">		/// &lt;summary&gt;Bind a conditional variable with a owned reader lock and release it for a period of time. When the function returns, the condition variable is activated or it is time out, and the current thread owned the reader lock again. This function is only available in Windows.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;lock&quot;&gt;The reader lock.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;ms&quot;&gt;Time in milliseconds.&lt;/param&gt;</div>
<div class="disabled">		bool										SleepWithReaderForTime(ReaderWriterLock&amp; lock, vint ms);</div>
<div class="disabled">		/// &lt;summary&gt;Bind a conditional variable with a owned writer lock and release it. When the function returns, the condition variable is activated, and the current thread owned the writer lock again. This function is only available in Windows.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;lock&quot;&gt;The writer lock.&lt;/param&gt;</div>
<div class="disabled">		bool										SleepWithWriter(ReaderWriterLock&amp; lock);</div>
<div class="disabled">		/// &lt;summary&gt;Bind a conditional variable with a owned writer lock and release it for a period of time. When the function returns, the condition variable is activated or it is time out, and the current thread owned the writer lock again. This function is only available in Windows.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;lock&quot;&gt;The writer lock.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;ms&quot;&gt;Time in milliseconds.&lt;/param&gt;</div>
<div class="disabled">		bool										SleepWithWriterForTime(ReaderWriterLock&amp; lock, vint ms);</div>
<div class="disabled">#endif</div>
<div class="disabled">		/// &lt;summary&gt;Wake one thread that pending on this condition variable.&lt;/summary&gt;</div>
<div class="disabled">		void										WakeOnePending();</div>
<div class="disabled">		/// &lt;summary&gt;Wake all thread that pending on this condition variable.&lt;/summary&gt;</div>
<div class="disabled">		void										WakeAllPendings();</div>
<div class="disabled">	};</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">User Mode Objects</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">	typedef long LockedInt;</div>
<div class="disabled">	</div>
<div class="disabled">	/// &lt;summary&gt;&lt;![CDATA[</div>
<div class="disabled">	/// Spin lock. It is similar to mutex.</div>
<div class="disabled">	/// The macro &quot;SPIN_LOCK&quot; is encouraged to use instead of calling [M:vl.SpinLock.Enter] and [M:vl.SpinLock.Leave] like this:</div>
<div class="disabled">	/// SPIN_LOCK(yourLock)</div>
<div class="disabled">	/// {</div>
<div class="disabled">	///		&lt;code&gt;</div>
<div class="disabled">	/// }</div>
<div class="disabled">	/// ]]&gt;&lt;/summary&gt;</div>
<div class="disabled">	class SpinLock : public Object, public NotCopyable</div>
<div class="disabled">	{</div>
<div class="disabled">	protected:</div>
<div class="disabled">		volatile LockedInt							token;</div>
<div class="disabled">	public:</div>
<div class="disabled">		/// &lt;summary&gt;Create a spin lock.&lt;/summary&gt;</div>
<div class="disabled">		SpinLock();</div>
<div class="disabled">		~SpinLock();</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Try enter a spin lock. This function will return immediately.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if the current thread owned the spin lock.&lt;/returns&gt;</div>
<div class="disabled">		bool										TryEnter();</div>
<div class="disabled">		/// &lt;summary&gt;Enter a spin lock.&lt;/summary&gt;</div>
<div class="disabled">		void										Enter();</div>
<div class="disabled">		/// &lt;summary&gt;Leave a spin lock.&lt;/summary&gt;</div>
<div class="disabled">		void										Leave();</div>

<div class="disabled">	public:</div>
<div class="disabled">		class Scope : public Object, public NotCopyable</div>
<div class="disabled">		{</div>
<div class="disabled">		private:</div>
<div class="disabled">			SpinLock*								spinLock;</div>
<div class="disabled">		public:</div>
<div class="disabled">			Scope(SpinLock&amp; _spinLock);</div>
<div class="disabled">			~Scope();</div>
<div class="disabled">		};</div>
<div class="disabled">	};</div>

<div class="disabled">#define SPIN_LOCK(LOCK) SCOPE_VARIABLE(const SpinLock::Scope&amp;, scope, LOCK)</div>
<div class="disabled">#define CS_LOCK(LOCK) SCOPE_VARIABLE(const CriticalSection::Scope&amp;, scope, LOCK)</div>
<div class="disabled">#define READER_LOCK(LOCK) SCOPE_VARIABLE(const ReaderWriterLock::ReaderScope&amp;, scope, LOCK)</div>
<div class="disabled">#define WRITER_LOCK(LOCK) SCOPE_VARIABLE(const ReaderWriterLock::WriterScope&amp;, scope, LOCK)</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Thread Local Storage</div>

<div class="disabled">ThreadLocalStorage and ThreadVariable&lt;T&gt; are designed to be used as global value types only.</div>
<div class="disabled">Dynamically create instances of them are undefined behavior.</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">	/// &lt;summary&gt;Thread local storage operations.&lt;/summary&gt;</div>
<div class="disabled">	class ThreadLocalStorage : public Object, private NotCopyable</div>
<div class="disabled">	{</div>
<div class="disabled">		typedef void(*Destructor)(void*);</div>
<div class="disabled">	protected:</div>
<div class="disabled">		vuint64_t								key;</div>
<div class="disabled">		Destructor								destructor;</div>
<div class="disabled">		volatile bool							disposed = false;</div>
<div class="disabled">		</div>
<div class="disabled">		static void								PushStorage(ThreadLocalStorage* storage);</div>
<div class="disabled">	public:</div>
<div class="disabled">		ThreadLocalStorage(Destructor _destructor);</div>
<div class="disabled">		~ThreadLocalStorage();</div>

<div class="disabled">		void*									Get();</div>
<div class="disabled">		void									Set(void* data);</div>
<div class="disabled">		void									Clear();</div>
<div class="disabled">		void									Dispose();</div>

<div class="disabled">		/// &lt;summary&gt;Fix all storage creation.&lt;/summary&gt;</div>
<div class="disabled">		static void								FixStorages();</div>
<div class="disabled">		/// &lt;summary&gt;Clear all storages for the current thread. For threads that are created using [T:vl.Thread], this function will be automatically called when before the thread exit.&lt;/summary&gt;</div>
<div class="disabled">		static void								ClearStorages();</div>
<div class="disabled">		/// &lt;summary&gt;Clear all storages for the current thread (should be the main thread) and clear all records. This function can only be called by the main thread when all other threads are exited. It will reduce noices when you want to detect memory leaks.&lt;/summary&gt;</div>
<div class="disabled">		static void								DisposeStorages();</div>
<div class="disabled">	};</div>

<div class="disabled">	/// &lt;summary&gt;Thread local variable. This type can only be used to define global variables. Different threads can store different values to and obtain differnt values from a thread local variable.&lt;/summary&gt;</div>
<div class="disabled">	/// &lt;typeparam name=&quot;T&quot;&gt;Type of the storage.&lt;/typeparam&gt;</div>
<div class="disabled">	template&lt;typename T&gt;</div>
<div class="disabled">	class ThreadVariable : public Object, private NotCopyable</div>
<div class="disabled">	{</div>
<div class="disabled">	protected:</div>
<div class="disabled">		ThreadLocalStorage						storage;</div>

<div class="disabled">		static void Destructor(void* data)</div>
<div class="disabled">		{</div>
<div class="disabled">			if (data)</div>
<div class="disabled">			{</div>
<div class="disabled">				delete (T*)data;</div>
<div class="disabled">			}</div>
<div class="disabled">		}</div>
<div class="disabled">	public:</div>
<div class="disabled">		/// &lt;summary&gt;Create a thread local variable.&lt;/summary&gt;</div>
<div class="disabled">		ThreadVariable()</div>
<div class="disabled">			:storage(&amp;Destructor)</div>
<div class="disabled">		{</div>
<div class="disabled">		}</div>

<div class="disabled">		~ThreadVariable()</div>
<div class="disabled">		{</div>
<div class="disabled">		}</div>

<div class="disabled">		/// &lt;summary&gt;Test if the storage has data.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;Returns true if the storage has data.&lt;/returns&gt;</div>
<div class="disabled">		bool HasData()</div>
<div class="disabled">		{</div>
<div class="disabled">			return storage.Get() != nullptr;</div>
<div class="disabled">		}</div>

<div class="disabled">		/// &lt;summary&gt;Remove the data from this storage.&lt;/summary&gt;</div>
<div class="disabled">		void Clear()</div>
<div class="disabled">		{</div>
<div class="disabled">			storage.Clear();</div>
<div class="disabled">		}</div>

<div class="disabled">		/// &lt;summary&gt;Get the stored data.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;returns&gt;The stored ata.&lt;/returns&gt;</div>
<div class="disabled">		T&amp; Get()</div>
<div class="disabled">		{</div>
<div class="disabled">			return *(T*)storage.Get();</div>
<div class="disabled">		}</div>

<div class="disabled">		/// &lt;summary&gt;Set data to this storage.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;value&quot;&gt;The data to set.&lt;/param&gt;</div>
<div class="disabled">		void Set(const T&amp; value)</div>
<div class="disabled">		{</div>
<div class="disabled">			storage.Clear();</div>
<div class="disabled">			storage.Set(new T(value));</div>
<div class="disabled">		}</div>
<div class="disabled">	};</div>

<div class="disabled">	template&lt;typename T&gt;</div>
<div class="disabled">	class ThreadVariable&lt;T*&gt; : public Object, private NotCopyable</div>
<div class="disabled">	{</div>
<div class="disabled">	protected:</div>
<div class="disabled">		ThreadLocalStorage						storage;</div>

<div class="disabled">	public:</div>
<div class="disabled">		ThreadVariable()</div>
<div class="disabled">			:storage(nullptr)</div>
<div class="disabled">		{</div>
<div class="disabled">		}</div>

<div class="disabled">		~ThreadVariable()</div>
<div class="disabled">		{</div>
<div class="disabled">		}</div>

<div class="disabled">		bool HasData()</div>
<div class="disabled">		{</div>
<div class="disabled">			return storage.Get() != nullptr;</div>
<div class="disabled">		}</div>

<div class="disabled">		void Clear()</div>
<div class="disabled">		{</div>
<div class="disabled">			storage.Set(nullptr);</div>
<div class="disabled">		}</div>

<div class="disabled">		T* Get()</div>
<div class="disabled">		{</div>
<div class="disabled">			return (T*)storage.Get();</div>
<div class="disabled">		}</div>

<div class="disabled">		void Set(T* value)</div>
<div class="disabled">		{</div>
<div class="disabled">			storage.Set((void*)value);</div>
<div class="disabled">		}</div>
<div class="disabled">	};</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">RepeatingTaskExecutor</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">	/// &lt;summary&gt;Queued task executor. It is different from a thread pool by: 1) Task execution is single threaded, 2) If you queue a task, it will override the the unexecuted queued task.&lt;/summary&gt;</div>
<div class="disabled">	/// &lt;typeparam name=&quot;T&quot;&gt;The type of the argument to run a task.&lt;/typeparam&gt;</div>
<div class="disabled">	template&lt;typename T&gt;</div>
<div class="disabled">	class RepeatingTaskExecutor : public Object</div>
<div class="disabled">	{</div>
<div class="disabled">	private:</div>
<div class="disabled">		SpinLock								inputLock;</div>
<div class="disabled">		T										inputData;</div>
<div class="disabled">		volatile bool							inputDataAvailable;</div>
<div class="disabled">		SpinLock								executingEvent;</div>
<div class="disabled">		volatile bool							executing;</div>

<div class="disabled">		void ExecutingProcInternal()</div>
<div class="disabled">		{</div>
<div class="disabled">			while(true)</div>
<div class="disabled">			{</div>
<div class="disabled">				bool currentInputDataAvailable;</div>
<div class="disabled">				T currentInputData;</div>
<div class="disabled">				SPIN_LOCK(inputLock)</div>
<div class="disabled">				{</div>
<div class="disabled">					currentInputData=inputData;</div>
<div class="disabled">					inputData=T();</div>
<div class="disabled">					currentInputDataAvailable=inputDataAvailable;</div>
<div class="disabled">					inputDataAvailable=false;</div>
<div class="disabled">					if(!currentInputDataAvailable)</div>
<div class="disabled">					{</div>
<div class="disabled">						executing=false;</div>
<div class="disabled">						goto FINISH_EXECUTING;</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">				Execute(currentInputData);</div>
<div class="disabled">			}</div>
<div class="disabled">		FINISH_EXECUTING:</div>
<div class="disabled">			executingEvent.Leave();</div>
<div class="disabled">		}</div>

<div class="disabled">		static void ExecutingProc(void* argument)</div>
<div class="disabled">		{</div>
<div class="disabled">			((RepeatingTaskExecutor&lt;T&gt;*)argument)-&gt;ExecutingProcInternal();</div>
<div class="disabled">		}</div>
<div class="disabled">	</div>
<div class="disabled">	protected:</div>
<div class="disabled">		/// &lt;summary&gt;This function is called when it is ready to execute a task. Task execution is single threaded. All task code should be put inside the function.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;input&quot;&gt;The argument to run a task.&lt;/param&gt;</div>
<div class="disabled">		virtual void							Execute(const T&amp; input)=0;</div>

<div class="disabled">	public:</div>
<div class="disabled">		/// &lt;summary&gt;Create a task executor.&lt;/summary&gt;</div>
<div class="disabled">		RepeatingTaskExecutor()</div>
<div class="disabled">			:inputDataAvailable(false)</div>
<div class="disabled">			,executing(false)</div>
<div class="disabled">		{</div>
<div class="disabled">		}</div>

<div class="disabled">		~RepeatingTaskExecutor()</div>
<div class="disabled">		{</div>
<div class="disabled">			EnsureTaskFinished();</div>
<div class="disabled">		}</div>

<div class="disabled">		/// &lt;summary&gt;Wait for all tasks to finish.&lt;/summary&gt;</div>
<div class="disabled">		void EnsureTaskFinished()</div>
<div class="disabled">		{</div>
<div class="disabled">			executingEvent.Enter();</div>
<div class="disabled">			executingEvent.Leave();</div>
<div class="disabled">		}</div>

<div class="disabled">		/// &lt;summary&gt;Queue a task. If there is a queued task that has not been executied yet, those tasks will be canceled. Only one task can be queued at the same moment.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;input&quot;&gt;The argument to run a task.&lt;/param&gt;</div>
<div class="disabled">		void SubmitTask(const T&amp; input)</div>
<div class="disabled">		{</div>
<div class="disabled">			SPIN_LOCK(inputLock)</div>
<div class="disabled">			{</div>
<div class="disabled">				inputData=input;</div>
<div class="disabled">				inputDataAvailable=true;</div>
<div class="disabled">			}</div>
<div class="disabled">			if(!executing)</div>
<div class="disabled">			{</div>
<div class="disabled">				executing=true;</div>
<div class="disabled">				executingEvent.Enter();</div>
<div class="disabled">				ThreadPoolLite::Queue(&amp;ExecutingProc, this);</div>
<div class="disabled">			}</div>
<div class="disabled">		}</div>
<div class="disabled">	};</div>
<div class="disabled">}</div>
<div class="disabled">#endif</div>


<div class="token cpp_comment ">/***********************************************************************
.\STREAM\INTERFACES.H
***********************************************************************/</div>
<div class="token cpp_comment ">/***********************************************************************
Vczh Library++ 3.0
Developer: Zihan Chen(vczh)
Stream::Interfaces

Interfaces:
	IStream							: Stream
***********************************************************************/</div>

<div class="disabled">#ifndef VCZH_STREAM_INTERFACES</div>
<div class="disabled">#define VCZH_STREAM_INTERFACES</div>


<div class="disabled">namespace vl</div>
<div class="disabled">{</div>
<div class="disabled">	namespace stream</div>
<div class="disabled">	{</div>
<div class="disabled">		/// &lt;summary&gt;</div>
<div class="disabled">		/// Interface for streams. Stream functions are grouped into 5 categories:</div>
<div class="disabled">		/// 1) Feature testing functions.</div>
<div class="disabled">		/// 2) Read functions, available only if [M:vl.stream.IStream.CanRead] returns true.</div>
<div class="disabled">		/// 3) Peek functions, available only if [M:vl.stream.IStream.CanPeek] returns true.</div>
<div class="disabled">		/// 4) Write functions, available only if [M:vl.stream.IStream.CanWrite] returns true.</div>
<div class="disabled">		/// 5) Seek functions, available only if [M:vl.stream.IStream.CanSeek] returns true.</div>
<div class="disabled">		/// 6) Size functions, available only if [M:vl.stream.IStream.IsLimited] returns true. But there are still some streams knows that the content is limited, but the size is unknown. In this case, [M:vl.stream.IStream.Size] will return -1.</div>
<div class="disabled">		/// &lt;/summary&gt;</div>
<div class="disabled">		class IStream : public virtual Interface</div>
<div class="disabled">		{</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Test if the stream is readable.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if the stream is readable.&lt;/returns&gt;</div>
<div class="disabled">			virtual bool					CanRead()const=0;</div>
<div class="disabled">			/// &lt;summary&gt;Test if the stream is writable.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if the stream is writable.&lt;/returns&gt;</div>
<div class="disabled">			virtual bool					CanWrite()const=0;</div>
<div class="disabled">			/// &lt;summary&gt;Test if the stream is seekable.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if the stream is seekable.&lt;/returns&gt;</div>
<div class="disabled">			virtual bool					CanSeek()const=0;</div>
<div class="disabled">			/// &lt;summary&gt;Test if the stream is peekable.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if the stream is peekable.&lt;/returns&gt;</div>
<div class="disabled">			virtual bool					CanPeek()const=0;</div>
<div class="disabled">			/// &lt;summary&gt;Test if the content of the stream is limited. A writable stream can also be limited, it means that you can only write a limited content to the stream.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if the content of the stream is limited.&lt;/returns&gt;</div>
<div class="disabled">			virtual bool					IsLimited()const=0;</div>
<div class="disabled">			/// &lt;summary&gt;Test if the stream is available. For example, if you create a readable [T:vl.stream.FileStream] giving a wrong file name, it will be unavailable.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if the stream is available.&lt;/returns&gt;</div>
<div class="disabled">			virtual bool					IsAvailable()const=0;</div>
<div class="disabled">			/// &lt;summary&gt;Close the stream.&lt;/summary&gt;</div>
<div class="disabled">			virtual void					Close()=0;</div>
<div class="disabled">			/// &lt;summary&gt;Get the current position in the stream.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The position in the stream. Returns -1 if the stream is not available.&lt;/returns&gt;</div>
<div class="disabled">			virtual pos_t					Position()const=0;</div>
<div class="disabled">			/// &lt;summary&gt;Get the size of the content..&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The size of the content. Returns -1 if the size is unknown or the stream is not available.&lt;/returns&gt;</div>
<div class="disabled">			virtual pos_t					Size()const=0;</div>
<div class="disabled">			/// &lt;summary&gt;Step forward or backward from the current position. Will throw exception if the stream is not seekable or not available.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_size&quot;&gt;The length of the step.&lt;/param&gt;</div>
<div class="disabled">			virtual void					Seek(pos_t _size)=0;</div>
<div class="disabled">			/// &lt;summary&gt;Step fowward from the beginning. Will throw exception if the stream is not seekable or not available.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_size&quot;&gt;The length of the step.&lt;/param&gt;</div>
<div class="disabled">			virtual void					SeekFromBegin(pos_t _size)=0;</div>
<div class="disabled">			/// &lt;summary&gt;Step backward from the end. Will throw exception if the stream is not seekable or not available.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_size&quot;&gt;The length of the step.&lt;/param&gt;</div>
<div class="disabled">			virtual void					SeekFromEnd(pos_t _size)=0;</div>
<div class="disabled">			/// &lt;summary&gt;Read from the current position and step forward. Will throw exception if the stream is not readable or not available.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns the actual size of the content that is read. Returns 0 indicates that the stream reaches the end if the stream is limited.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_buffer&quot;&gt;A buffer to store the content.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_size&quot;&gt;The size of the content that is expected to read.&lt;/param&gt;</div>
<div class="disabled">			virtual vint					Read(void* _buffer, vint _size)=0;</div>
<div class="disabled">			/// &lt;summary&gt;Write to the current position and step forward. Will throw exception if the stream is not writable or not available.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns the actual size of the content that is written. Returns 0 indicates that the stream reaches the end if the stream is limited.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_buffer&quot;&gt;A buffer storing the content to write.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_size&quot;&gt;The size of the content that is expected to write.&lt;/param&gt;</div>
<div class="disabled">			virtual vint					Write(void* _buffer, vint _size)=0;</div>
<div class="disabled">			/// &lt;summary&gt;Read from the current position but not step forward. Will throw exception if the stream is not peekable or not available.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns the actual size of the content that is read. Returns 0 indicates that the stream reaches the end if the stream is limited.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_buffer&quot;&gt;A buffer to store the content.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_size&quot;&gt;The size of the content that is expected to peek.&lt;/param&gt;</div>
<div class="disabled">			virtual vint					Peek(void* _buffer, vint _size)=0;</div>
<div class="disabled">		};</div>

<div class="disabled">		/// &lt;summary&gt;Encoder interface. This interface defines a writable transformation from one stream to another stream. You can create a [T:vl.stream.EncoderStream] after you have an encoder.&lt;/summary&gt;</div>
<div class="disabled">		class IEncoder : public Interface</div>
<div class="disabled">		{</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Set a target writable stream. The &lt;see cref=&quot;Write&quot;/&gt; function will transform the content and write to this tream.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_stream&quot;&gt;The target writable stream.&lt;/param&gt;</div>
<div class="disabled">			virtual void					Setup(IStream* _stream)=0;</div>
<div class="disabled">			/// &lt;summary&gt;Stop the transformation, ensuring all written content is transformed to the target stream.&lt;/summary&gt;</div>
<div class="disabled">			virtual	void					Close()=0;</div>
<div class="disabled">			/// &lt;summary&gt;Transform content and write to the target stream. This function may cache something to increase performance, so it cannot expect that all transformed content will be written to the target stream immediately.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns the actual size of the content before transforming that is written. The content is treated as being written even it is cached and not actually write to the target stream.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_buffer&quot;&gt;A buffer storing the content to write.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_size&quot;&gt;The size of the content that is expected to write.&lt;/param&gt;</div>
<div class="disabled">			virtual vint					Write(void* _buffer, vint _size)=0;</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Decoder interface. This interface defines a readable transformation from one stream to another stream. You can create a [T:vl.stream.DecoderStream] after you have an decoder.&lt;/summary&gt;</div>
<div class="disabled">		class IDecoder : public Interface</div>
<div class="disabled">		{</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Set a target readable stream. The &lt;see cref=&quot;Read&quot;/&gt; function will read from this tream and transform the content.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_stream&quot;&gt;The target readable stream.&lt;/param&gt;</div>
<div class="disabled">			virtual void					Setup(IStream* _stream)=0;</div>
<div class="disabled">			/// &lt;summary&gt;Stop the transformation.&lt;/summary&gt;</div>
<div class="disabled">			virtual	void					Close()=0;</div>
<div class="disabled">			/// &lt;summary&gt;Read from the target stream and transform the content.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns the actual size of the content after transforming that is read.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_buffer&quot;&gt;A buffer to store the content.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_size&quot;&gt;The size of the content that is expected to read.&lt;/param&gt;</div>
<div class="disabled">			virtual vint					Read(void* _buffer, vint _size)=0;</div>
<div class="disabled">		};</div>
<div class="disabled">	}</div>
<div class="disabled">}</div>

<div class="disabled">#endif</div>

<div class="token cpp_comment ">/***********************************************************************
.\STREAM\BROADCASTSTREAM.H
***********************************************************************/</div>
<div class="token cpp_comment ">/***********************************************************************
Vczh Library++ 3.0
Developer: Zihan Chen(vczh)
Stream::BroadcastStream

Interfaces:
	BroadcastStream					: Stream that copy the written data to multiple streams
***********************************************************************/</div>

<div class="disabled">#ifndef VCZH_STREAM_BROADCASTSTREAM</div>
<div class="disabled">#define VCZH_STREAM_BROADCASTSTREAM</div>


<div class="disabled">namespace vl</div>
<div class="disabled">{</div>
<div class="disabled">	namespace stream</div>
<div class="disabled">	{</div>
<div class="disabled">		/// &lt;summary&gt;A writable stream that copy written content to multiple target streams.&lt;/summary&gt;</div>
<div class="disabled">		class BroadcastStream : public Object, public virtual IStream</div>
<div class="disabled">		{</div>
<div class="disabled">			typedef collections::List&lt;IStream*&gt;		StreamList;</div>
<div class="disabled">		protected:</div>
<div class="disabled">			bool					closed;</div>
<div class="disabled">			pos_t					position;</div>
<div class="disabled">			StreamList				streams;</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create a strema.&lt;/summary&gt;</div>
<div class="disabled">			BroadcastStream();</div>
<div class="disabled">			~BroadcastStream();</div>

<div class="disabled">			/// &lt;summary&gt;Get the list of target streams. You can add streams to this list, or remove streams from this list.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The list of target streams.&lt;/returns&gt;</div>
<div class="disabled">			StreamList&amp;				Targets();</div>
<div class="disabled">			bool					CanRead()const;</div>
<div class="disabled">			bool					CanWrite()const;</div>
<div class="disabled">			bool					CanSeek()const;</div>
<div class="disabled">			bool					CanPeek()const;</div>
<div class="disabled">			bool					IsLimited()const;</div>
<div class="disabled">			bool					IsAvailable()const;</div>
<div class="disabled">			void					Close();</div>
<div class="disabled">			pos_t					Position()const;</div>
<div class="disabled">			pos_t					Size()const;</div>
<div class="disabled">			void					Seek(pos_t _size);</div>
<div class="disabled">			void					SeekFromBegin(pos_t _size);</div>
<div class="disabled">			void					SeekFromEnd(pos_t _size);</div>
<div class="disabled">			vint					Read(void* _buffer, vint _size);</div>
<div class="disabled">			vint					Write(void* _buffer, vint _size);</div>
<div class="disabled">			vint					Peek(void* _buffer, vint _size);</div>
<div class="disabled">		};</div>
<div class="disabled">	}</div>
<div class="disabled">}</div>

<div class="disabled">#endif</div>

<div class="token cpp_comment ">/***********************************************************************
.\STREAM\CACHESTREAM.H
***********************************************************************/</div>
<div class="token cpp_comment ">/***********************************************************************
Vczh Library++ 3.0
Developer: Zihan Chen(vczh)
Stream::CacheStream

Interfaces:
	CacheStream						: Stream that provide a cache for reading and writing
***********************************************************************/</div>

<div class="disabled">#ifndef VCZH_STREAM_CACHESTREAM</div>
<div class="disabled">#define VCZH_STREAM_CACHESTREAM</div>


<div class="disabled">namespace vl</div>
<div class="disabled">{</div>
<div class="disabled">	namespace stream</div>
<div class="disabled">	{</div>
<div class="disabled">		/// &lt;summary&gt;</div>
<div class="disabled">		/// A cache stream. Features (readable, writable, seekable, peekable) are enabled according to the target stream.</div>
<div class="disabled">		/// When you read from the cache strema, it will read a specified size of content from the target stream first and cache, reducing the numbers of operations on the target stream.</div>
<div class="disabled">		/// When you write to the cache strema, it will save them to a buffer, and write to the target stream until the buffer reaches a specified size, reducing the numbers of operations on the target stream.</div>
<div class="disabled">		/// &lt;/summary&gt;</div>
<div class="disabled">		class CacheStream : public Object, public virtual IStream</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			IStream*				target;</div>
<div class="disabled">			vint					block;</div>
<div class="disabled">			pos_t					start;</div>
<div class="disabled">			pos_t					position;</div>

<div class="disabled">			char*					buffer;</div>
<div class="disabled">			vint					dirtyStart;</div>
<div class="disabled">			vint					dirtyLength;</div>
<div class="disabled">			vint					availableLength;</div>
<div class="disabled">			pos_t					operatedSize;</div>

<div class="disabled">			void					Flush();</div>
<div class="disabled">			void					Load(pos_t _position);</div>
<div class="disabled">			vint					InternalRead(void* _buffer, vint _size);</div>
<div class="disabled">			vint					InternalWrite(void* _buffer, vint _size);</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create a cache stream using a target stream.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_target&quot;&gt;The target stream.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_block&quot;&gt;Size of the cache.&lt;/param&gt;</div>
<div class="disabled">			CacheStream(IStream&amp; _target, vint _block=65536);</div>
<div class="disabled">			~CacheStream();</div>

<div class="disabled">			bool					CanRead()const;</div>
<div class="disabled">			bool					CanWrite()const;</div>
<div class="disabled">			bool					CanSeek()const;</div>
<div class="disabled">			bool					CanPeek()const;</div>
<div class="disabled">			bool					IsLimited()const;</div>
<div class="disabled">			bool					IsAvailable()const;</div>
<div class="disabled">			void					Close();</div>
<div class="disabled">			pos_t					Position()const;</div>
<div class="disabled">			pos_t					Size()const;</div>
<div class="disabled">			void					Seek(pos_t _size);</div>
<div class="disabled">			void					SeekFromBegin(pos_t _size);</div>
<div class="disabled">			void					SeekFromEnd(pos_t _size);</div>
<div class="disabled">			vint					Read(void* _buffer, vint _size);</div>
<div class="disabled">			vint					Write(void* _buffer, vint _size);</div>
<div class="disabled">			vint					Peek(void* _buffer, vint _size);</div>
<div class="disabled">		};</div>
<div class="disabled">	}</div>
<div class="disabled">}</div>

<div class="disabled">#endif</div>

<div class="token cpp_comment ">/***********************************************************************
.\STREAM\COMPRESSIONSTREAM.H
***********************************************************************/</div>
<div class="token cpp_comment ">/***********************************************************************
Vczh Library++ 3.0
Developer: Zihan Chen(vczh)
Stream::CharFormat

Classes:
***********************************************************************/</div>

<div class="disabled">#ifndef VCZH_STREAM_COMPRESSIONSTREAM</div>
<div class="disabled">#define VCZH_STREAM_COMPRESSIONSTREAM</div>


<div class="disabled">namespace vl</div>
<div class="disabled">{</div>
<div class="disabled">	namespace stream</div>
<div class="disabled">	{</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Compression</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">		namespace lzw</div>
<div class="disabled">		{</div>
<div class="disabled">			static const vint						BufferSize = 1024;</div>
<div class="disabled">			static const vint						MaxDictionarySize = 1 &lt;&lt; 24;</div>

<div class="disabled">			struct Code</div>
<div class="disabled">			{</div>
<div class="disabled">				typedef collections::PushOnlyAllocator&lt;Code&gt;			CodeAllocator;</div>
<div class="disabled">				typedef collections::ByteObjectMap&lt;Code&gt;::Allocator		MapAllocator;</div>

<div class="disabled">				vuint8_t							byte = 0;</div>
<div class="disabled">				vint								code = -1;</div>
<div class="disabled">				Code*								parent = 0;</div>
<div class="disabled">				vint								size = 0;</div>
<div class="disabled">				collections::ByteObjectMap&lt;Code&gt;	children;</div>
<div class="disabled">			};</div>
<div class="disabled">		}</div>

<div class="disabled">		class LzwBase : public Object</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			lzw::Code::CodeAllocator				codeAllocator;</div>
<div class="disabled">			lzw::Code::MapAllocator					mapAllocator;</div>
<div class="disabled">			lzw::Code*								root;</div>
<div class="disabled">			vint									eofIndex = -1;</div>
<div class="disabled">			vint									nextIndex = 0;</div>
<div class="disabled">			vint									indexBits = 1;</div>

<div class="disabled">			void									UpdateIndexBits();</div>
<div class="disabled">			lzw::Code*								CreateCode(lzw::Code* parent, vuint8_t byte);</div>

<div class="disabled">			LzwBase();</div>
<div class="disabled">			LzwBase(bool (&amp;existingBytes)[256]);</div>
<div class="disabled">			~LzwBase();</div>
<div class="disabled">		};</div>

<div class="disabled">		/// &lt;summary&gt;An encoder to compress using Lzw algorithm.&lt;/summary&gt;</div>
<div class="disabled">		class LzwEncoder : public LzwBase, public IEncoder</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			IStream*								stream = 0;</div>

<div class="disabled">			vuint8_t								buffer[lzw::BufferSize];</div>
<div class="disabled">			vint									bufferUsedBits = 0;</div>
<div class="disabled">			lzw::Code*								prefix;</div>

<div class="disabled">			void									Flush();</div>
<div class="disabled">			void									WriteNumber(vint number, vint bitSize);</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create an encoder.&lt;/summary&gt;</div>
<div class="disabled">			LzwEncoder();</div>
<div class="disabled">			/// &lt;summary&gt;Create an encoder and tell it which byte will never appear in the data before compression.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;existingBytes&quot;&gt;An array to tell the encoder which byte will never appear in the data before compression.&lt;/param&gt;</div>
<div class="disabled">			LzwEncoder(bool (&amp;existingBytes)[256]);</div>
<div class="disabled">			~LzwEncoder();</div>

<div class="disabled">			void									Setup(IStream* _stream)override;</div>
<div class="disabled">			void									Close()override;</div>
<div class="disabled">			vint									Write(void* _buffer, vint _size)override;</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;An decoder to decompress using Lzw algorithm.&lt;/summary&gt;</div>
<div class="disabled">		class LzwDecoder :public LzwBase, public IDecoder</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			IStream*								stream = 0;</div>
<div class="disabled">			collections::List&lt;lzw::Code*&gt;			dictionary;</div>
<div class="disabled">			lzw::Code*								lastCode = 0;</div>

<div class="disabled">			vuint8_t								inputBuffer[lzw::BufferSize];</div>
<div class="disabled">			vint									inputBufferSize = 0;</div>
<div class="disabled">			vint									inputBufferUsedBits = 0;</div>

<div class="disabled">			collections::Array&lt;vuint8_t&gt;			outputBuffer;</div>
<div class="disabled">			vint									outputBufferSize = 0;</div>
<div class="disabled">			vint									outputBufferUsedBytes = 0;</div>

<div class="disabled">			bool									ReadNumber(vint&amp; number, vint bitSize);</div>
<div class="disabled">			void									PrepareOutputBuffer(vint size);</div>
<div class="disabled">			void									ExpandCodeToOutputBuffer(lzw::Code* code);</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create an decoder.&lt;/summary&gt;</div>
<div class="disabled">			LzwDecoder();</div>
<div class="disabled">			/// &lt;summary&gt;Create an decoder and tell it which byte will never appear in the data before compression.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;existingBytes&quot;&gt;An array to tell the encoder which byte will never appear in the data before compression.&lt;/param&gt;</div>
<div class="disabled">			LzwDecoder(bool (&amp;existingBytes)[256]);</div>
<div class="disabled">			~LzwDecoder();</div>

<div class="disabled">			void									Setup(IStream* _stream)override;</div>
<div class="disabled">			void									Close()override;</div>
<div class="disabled">			vint									Read(void* _buffer, vint _size)override;</div>
<div class="disabled">		};</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Helper Functions</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">		extern vint						CopyStream(stream::IStream&amp; inputStream, stream::IStream&amp; outputStream);</div>
<div class="disabled">		extern void						CompressStream(stream::IStream&amp; inputStream, stream::IStream&amp; outputStream);</div>
<div class="disabled">		extern void						DecompressStream(stream::IStream&amp; inputStream, stream::IStream&amp; outputStream);</div>
<div class="disabled">	}</div>
<div class="disabled">}</div>

<div class="disabled">#endif</div>

<div class="token cpp_comment ">/***********************************************************************
.\STREAM\FILESTREAM.H
***********************************************************************/</div>
<div class="token cpp_comment ">/***********************************************************************
Vczh Library++ 3.0
Developer: Zihan Chen(vczh)
Stream::FileStream

Interfaces:
	FileStream						: File stream
***********************************************************************/</div>

<div class="disabled">#ifndef VCZH_STREAM_FILESTREAM</div>
<div class="disabled">#define VCZH_STREAM_FILESTREAM</div>

<div class="disabled">#include &lt;stdio.h&gt;</div>

<div class="disabled">namespace vl</div>
<div class="disabled">{</div>
<div class="disabled">	namespace stream</div>
<div class="disabled">	{</div>
<div class="disabled">		/// &lt;summary&gt;A file stream. It is readable when you use [F:vl.stream.FileStream.AccessRight.ReadOnly] or [F:vl.stream.FileStream.AccessRight.ReadWrite] to create the stream. It is writable when you use [F:vl.stream.FileStream.AccessRight.WriteOnly] or [F:vl.stream.FileStream.AccessRight.ReadWrite] to create the stream.&lt;/summary&gt;</div>
<div class="disabled">		class FileStream : public Object, public virtual IStream</div>
<div class="disabled">		{</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Access to the file.&lt;/summary&gt;</div>
<div class="disabled">			enum AccessRight</div>
<div class="disabled">			{</div>
<div class="disabled">				/// &lt;summary&gt;The file is opened to read.&lt;/summary&gt;</div>
<div class="disabled">				ReadOnly,</div>
<div class="disabled">				/// &lt;summary&gt;The file is opened to write.&lt;/summary&gt;</div>
<div class="disabled">				WriteOnly,</div>
<div class="disabled">				/// &lt;summary&gt;The file is opened to both read and write.&lt;/summary&gt;</div>
<div class="disabled">				ReadWrite</div>
<div class="disabled">			};</div>
<div class="disabled">		protected:</div>
<div class="disabled">			AccessRight				accessRight;</div>
<div class="disabled">			FILE*					file;</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create a stream.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;fileName&quot;&gt;File to operate.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_accessRight&quot;&gt;Operations want to perform on the file.&lt;/param&gt;</div>
<div class="disabled">			FileStream(const WString&amp; fileName, AccessRight _accessRight);</div>
<div class="disabled">			~FileStream();</div>

<div class="disabled">			bool					CanRead()const;</div>
<div class="disabled">			bool					CanWrite()const;</div>
<div class="disabled">			bool					CanSeek()const;</div>
<div class="disabled">			bool					CanPeek()const;</div>
<div class="disabled">			bool					IsLimited()const;</div>
<div class="disabled">			bool					IsAvailable()const;</div>
<div class="disabled">			void					Close();</div>
<div class="disabled">			pos_t					Position()const;</div>
<div class="disabled">			pos_t					Size()const;</div>
<div class="disabled">			void					Seek(pos_t _size);</div>
<div class="disabled">			void					SeekFromBegin(pos_t _size);</div>
<div class="disabled">			void					SeekFromEnd(pos_t _size);</div>
<div class="disabled">			vint					Read(void* _buffer, vint _size);</div>
<div class="disabled">			vint					Write(void* _buffer, vint _size);</div>
<div class="disabled">			vint					Peek(void* _buffer, vint _size);</div>
<div class="disabled">		};</div>
<div class="disabled">	}</div>
<div class="disabled">}</div>

<div class="disabled">#endif</div>

<div class="token cpp_comment ">/***********************************************************************
.\STREAM\MEMORYSTREAM.H
***********************************************************************/</div>
<div class="token cpp_comment ">/***********************************************************************
Vczh Library++ 3.0
Developer: Zihan Chen(vczh)
Stream::MemoryStream

Interfaces:
	MemoryStream					: Memory stream
***********************************************************************/</div>

<div class="disabled">#ifndef VCZH_STREAM_MEMORYSTREAM</div>
<div class="disabled">#define VCZH_STREAM_MEMORYSTREAM</div>


<div class="disabled">namespace vl</div>
<div class="disabled">{</div>
<div class="disabled">	namespace stream</div>
<div class="disabled">	{</div>
<div class="disabled">		/// &lt;summary&gt;A readable, writable, seekable and peekable stream that stores everything in memory.&lt;/summary&gt;</div>
<div class="disabled">		class MemoryStream : public Object, public virtual IStream</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			vint					block;</div>
<div class="disabled">			char*					buffer;</div>
<div class="disabled">			vint					size;</div>
<div class="disabled">			vint					position;</div>
<div class="disabled">			vint					capacity;</div>

<div class="disabled">			void					PrepareSpace(vint totalSpace);</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create a stream.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_block&quot;&gt;Size for each allocation. The stream will only allocate new memory of size &quot;_block&quot; when it reaches the end and has to extend.&lt;/param&gt;</div>
<div class="disabled">			MemoryStream(vint _block=65536);</div>
<div class="disabled">			~MemoryStream();</div>

<div class="disabled">			bool					CanRead()const;</div>
<div class="disabled">			bool					CanWrite()const;</div>
<div class="disabled">			bool					CanSeek()const;</div>
<div class="disabled">			bool					CanPeek()const;</div>
<div class="disabled">			bool					IsLimited()const;</div>
<div class="disabled">			bool					IsAvailable()const;</div>
<div class="disabled">			void					Close();</div>
<div class="disabled">			pos_t					Position()const;</div>
<div class="disabled">			pos_t					Size()const;</div>
<div class="disabled">			void					Seek(pos_t _size);</div>
<div class="disabled">			void					SeekFromBegin(pos_t _size);</div>
<div class="disabled">			void					SeekFromEnd(pos_t _size);</div>
<div class="disabled">			vint					Read(void* _buffer, vint _size);</div>
<div class="disabled">			vint					Write(void* _buffer, vint _size);</div>
<div class="disabled">			vint					Peek(void* _buffer, vint _size);</div>
<div class="disabled">			void*					GetInternalBuffer();</div>
<div class="disabled">		};</div>
<div class="disabled">	}</div>
<div class="disabled">}</div>

<div class="disabled">#endif</div>

<div class="token cpp_comment ">/***********************************************************************
.\STREAM\ACCESSOR.H
***********************************************************************/</div>
<div class="token cpp_comment ">/***********************************************************************
Vczh Library++ 3.0
Developer: Zihan Chen(vczh)
Stream::Accessor

Classes:
	TextReader						: Text reader base class
	TextWriter						: Text writer base class
	StringReader					: Text reader from a string
	StreamReader					: Text reader from a stream
	StreamWriter					: Text writer to a stream
	EncoderStream					: Stream that takes an encoder to translate another stream
	DecoderStream					: Stream that takes a decoder to translate another stream
***********************************************************************/</div>

<div class="disabled">#ifndef VCZH_STREAM_ACCESSOR</div>
<div class="disabled">#define VCZH_STREAM_ACCESSOR</div>


<div class="disabled">namespace vl</div>
<div class="disabled">{</div>
<div class="disabled">	namespace stream</div>
<div class="disabled">	{</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Text Related</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">		/// &lt;summary&gt;Text reader. All line breaks are normalized to CRLF regardless the format in the source.&lt;/summary&gt;</div>
<div class="disabled">		class TextReader : public Object, private NotCopyable</div>
<div class="disabled">		{</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Test does the reader reach the end or not.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if the reader reaches the end.&lt;/returns&gt;</div>
<div class="disabled">			virtual bool				IsEnd()=0;</div>
<div class="disabled">			/// &lt;summary&gt;Read a single character.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The character.&lt;/returns&gt;</div>
<div class="disabled">			virtual wchar_t				ReadChar()=0;</div>
<div class="disabled">			/// &lt;summary&gt;Read a string of a specified size.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The string.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;length&quot;&gt;Expected length of the string to read.&lt;/param&gt;</div>
<div class="disabled">			virtual WString				ReadString(vint length);</div>
<div class="disabled">			/// &lt;summary&gt;Read a string until a line breaks is reached.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The string. It does not contain the line break.&lt;/returns&gt;</div>
<div class="disabled">			virtual WString				ReadLine();</div>
<div class="disabled">			/// &lt;summary&gt;Read everying remain.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The string.&lt;/returns&gt;</div>
<div class="disabled">			virtual WString				ReadToEnd();</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Text writer.&lt;/summary&gt;</div>
<div class="disabled">		class TextWriter : public Object, private NotCopyable</div>
<div class="disabled">		{</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Write a single character.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;c&quot;&gt;The character to write.&lt;/param&gt;</div>
<div class="disabled">			virtual void				WriteChar(wchar_t c)=0;</div>
<div class="disabled">			/// &lt;summary&gt;Write a string.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;string&quot;&gt;Buffer to the string to write.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;charCount&quot;&gt;Size of the string in characters not including the zero terminator.&lt;/param&gt;</div>
<div class="disabled">			virtual void				WriteString(const wchar_t* string, vint charCount);</div>
<div class="disabled">			/// &lt;summary&gt;Write a string.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;string&quot;&gt;Buffer to the zero terminated string to write.&lt;/param&gt;</div>
<div class="disabled">			virtual void				WriteString(const wchar_t* string);</div>
<div class="disabled">			/// &lt;summary&gt;Write a string.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;string&quot;&gt;The string to write.&lt;/param&gt;</div>
<div class="disabled">			virtual void				WriteString(const WString&amp; string);</div>
<div class="disabled">			/// &lt;summary&gt;Write a string with a CRLF.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;string&quot;&gt;Buffer to the string to write.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;charCount&quot;&gt;Size of the string in characters not including the zero terminator.&lt;/param&gt;</div>
<div class="disabled">			virtual void				WriteLine(const wchar_t* string, vint charCount);</div>
<div class="disabled">			/// &lt;summary&gt;Write a string with a CRLF.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;string&quot;&gt;Buffer to the zero terminated string to write.&lt;/param&gt;</div>
<div class="disabled">			virtual void				WriteLine(const wchar_t* string);</div>
<div class="disabled">			/// &lt;summary&gt;Write a string with a CRLF.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;string&quot;&gt;The string to write.&lt;/param&gt;</div>
<div class="disabled">			virtual void				WriteLine(const WString&amp; string);</div>

<div class="disabled">			virtual void				WriteMonospacedEnglishTable(collections::Array&lt;WString&gt;&amp; tableByRow, vint rows, vint columns);</div>
<div class="disabled">		};</div>

<div class="disabled">		/// &lt;summary&gt;Text reader from a string.&lt;/summary&gt;</div>
<div class="disabled">		class StringReader : public TextReader</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			WString						string;</div>
<div class="disabled">			vint						current;</div>
<div class="disabled">			bool						lastCallIsReadLine;</div>

<div class="disabled">			void						PrepareIfLastCallIsReadLine();</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create a text reader.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_string&quot;&gt;The string to read.&lt;/param&gt;</div>
<div class="disabled">			StringReader(const WString&amp; _string);</div>

<div class="disabled">			bool						IsEnd();</div>
<div class="disabled">			wchar_t						ReadChar();</div>
<div class="disabled">			WString						ReadString(vint length);</div>
<div class="disabled">			WString						ReadLine();</div>
<div class="disabled">			WString						ReadToEnd();</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Text reader from a stream.&lt;/summary&gt;</div>
<div class="disabled">		class StreamReader : public TextReader</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			IStream*					stream;</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create a text reader.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_stream&quot;&gt;The stream to read.&lt;/param&gt;</div>
<div class="disabled">			StreamReader(IStream&amp; _stream);</div>

<div class="disabled">			bool						IsEnd();</div>
<div class="disabled">			wchar_t						ReadChar();</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Text writer to a stream.&lt;/summary&gt;</div>
<div class="disabled">		class StreamWriter : public TextWriter</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			IStream*					stream;</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create a text writer.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_stream&quot;&gt;The stream to write.&lt;/param&gt;</div>
<div class="disabled">			StreamWriter(IStream&amp; _stream);</div>
<div class="disabled">			using TextWriter::WriteString;</div>

<div class="disabled">			void						WriteChar(wchar_t c);</div>
<div class="disabled">			void						WriteString(const wchar_t* string, vint charCount);</div>
<div class="disabled">		};</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Encoding Related</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">		/// &lt;summary&gt;Encoder stream, a writable stream using an [T:vl.stream.IEncoder] to transform content.&lt;/summary&gt;</div>
<div class="disabled">		class EncoderStream : public virtual IStream</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			IStream*					stream;</div>
<div class="disabled">			IEncoder*					encoder;</div>
<div class="disabled">			pos_t						position;</div>

<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create a stream.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_stream&quot;&gt;The target stream to write.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_encoder&quot;&gt;The encoder to transform content.&lt;/param&gt;</div>
<div class="disabled">			EncoderStream(IStream&amp; _stream, IEncoder&amp; _encoder);</div>
<div class="disabled">			~EncoderStream();</div>

<div class="disabled">			bool						CanRead()const;</div>
<div class="disabled">			bool						CanWrite()const;</div>
<div class="disabled">			bool						CanSeek()const;</div>
<div class="disabled">			bool						CanPeek()const;</div>
<div class="disabled">			bool						IsLimited()const;</div>
<div class="disabled">			bool						IsAvailable()const;</div>
<div class="disabled">			void						Close();</div>
<div class="disabled">			pos_t						Position()const;</div>
<div class="disabled">			pos_t						Size()const;</div>
<div class="disabled">			void						Seek(pos_t _size);</div>
<div class="disabled">			void						SeekFromBegin(pos_t _size);</div>
<div class="disabled">			void						SeekFromEnd(pos_t _size);</div>
<div class="disabled">			vint						Read(void* _buffer, vint _size);</div>
<div class="disabled">			vint						Write(void* _buffer, vint _size);</div>
<div class="disabled">			vint						Peek(void* _buffer, vint _size);</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Decoder stream, a readable stream using an [T:vl.stream.IDecoder] to transform content.&lt;/summary&gt;</div>
<div class="disabled">		class DecoderStream : public virtual IStream</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			IStream*					stream;</div>
<div class="disabled">			IDecoder*					decoder;</div>
<div class="disabled">			pos_t						position;</div>

<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create a stream.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_stream&quot;&gt;The target stream to read.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_decoder&quot;&gt;The decoder to transform content.&lt;/param&gt;</div>
<div class="disabled">			DecoderStream(IStream&amp; _stream, IDecoder&amp; _decoder);</div>
<div class="disabled">			~DecoderStream();</div>

<div class="disabled">			bool						CanRead()const;</div>
<div class="disabled">			bool						CanWrite()const;</div>
<div class="disabled">			bool						CanSeek()const;</div>
<div class="disabled">			bool						CanPeek()const;</div>
<div class="disabled">			bool						IsLimited()const;</div>
<div class="disabled">			bool						IsAvailable()const;</div>
<div class="disabled">			void						Close();</div>
<div class="disabled">			pos_t						Position()const;</div>
<div class="disabled">			pos_t						Size()const;</div>
<div class="disabled">			void						Seek(pos_t _size);</div>
<div class="disabled">			void						SeekFromBegin(pos_t _size);</div>
<div class="disabled">			void						SeekFromEnd(pos_t _size);</div>
<div class="disabled">			vint						Read(void* _buffer, vint _size);</div>
<div class="disabled">			vint						Write(void* _buffer, vint _size);</div>
<div class="disabled">			vint						Peek(void* _buffer, vint _size);</div>
<div class="disabled">		};</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Helper Functions</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">		template&lt;typename TCallback&gt;</div>
<div class="disabled">		WString GenerateToStream(const TCallback&amp; callback, vint block = 65536)</div>
<div class="disabled">		{</div>
<div class="disabled">			MemoryStream stream(block);</div>
<div class="disabled">			{</div>
<div class="disabled">				StreamWriter writer(stream);</div>
<div class="disabled">				callback(writer);</div>
<div class="disabled">			}</div>
<div class="disabled">			stream.SeekFromBegin(0);</div>
<div class="disabled">			{</div>
<div class="disabled">				StreamReader reader(stream);</div>
<div class="disabled">				return reader.ReadToEnd();</div>
<div class="disabled">			}</div>
<div class="disabled">		}</div>
<div class="disabled">	}</div>
<div class="disabled">}</div>

<div class="disabled">#endif</div>

<div class="token cpp_comment ">/***********************************************************************
.\STREAM\MEMORYWRAPPERSTREAM.H
***********************************************************************/</div>
<div class="token cpp_comment ">/***********************************************************************
Vczh Library++ 3.0
Developer: Zihan Chen(vczh)
Stream::MemoryWrapperStream

Interfaces:
	MemoryWrapperStream				: Memory stream which manipulate a given buffer
***********************************************************************/</div>

<div class="disabled">#ifndef VCZH_STREAM_MEMORYWRAPPERSTREAM</div>
<div class="disabled">#define VCZH_STREAM_MEMORYWRAPPERSTREAM</div>


<div class="disabled">namespace vl</div>
<div class="disabled">{</div>
<div class="disabled">	namespace stream</div>
<div class="disabled">	{</div>
<div class="disabled">		/// &lt;summary&gt;A readable, writable, seekable and peekable stream that operates a buffer.&lt;/summary&gt;</div>
<div class="disabled">		class MemoryWrapperStream : public Object, public virtual IStream</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			char*					buffer;</div>
<div class="disabled">			vint						size;</div>
<div class="disabled">			vint						position;</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create a stream.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_buffer&quot;&gt;The buffer to operate.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_size&quot;&gt;Size of the buffer.&lt;/param&gt;</div>
<div class="disabled">			MemoryWrapperStream(void* _buffer, vint _size);</div>
<div class="disabled">			~MemoryWrapperStream();</div>

<div class="disabled">			bool					CanRead()const;</div>
<div class="disabled">			bool					CanWrite()const;</div>
<div class="disabled">			bool					CanSeek()const;</div>
<div class="disabled">			bool					CanPeek()const;</div>
<div class="disabled">			bool					IsLimited()const;</div>
<div class="disabled">			bool					IsAvailable()const;</div>
<div class="disabled">			void					Close();</div>
<div class="disabled">			pos_t					Position()const;</div>
<div class="disabled">			pos_t					Size()const;</div>
<div class="disabled">			void					Seek(pos_t _size);</div>
<div class="disabled">			void					SeekFromBegin(pos_t _size);</div>
<div class="disabled">			void					SeekFromEnd(pos_t _size);</div>
<div class="disabled">			vint					Read(void* _buffer, vint _size);</div>
<div class="disabled">			vint					Write(void* _buffer, vint _size);</div>
<div class="disabled">			vint					Peek(void* _buffer, vint _size);</div>
<div class="disabled">		};</div>
<div class="disabled">	}</div>
<div class="disabled">}</div>

<div class="disabled">#endif</div>

<div class="token cpp_comment ">/***********************************************************************
.\STREAM\CHARFORMAT.H
***********************************************************************/</div>
<div class="token cpp_comment ">/***********************************************************************
Vczh Library++ 3.0
Developer: Zihan Chen(vczh)
Stream::CharFormat

Classes:
	CharEncoder									: Encoder to translate from wchar_t to some specified format
	CharDecoder									: Decoder to transate from some specified format to wchar_t
	MbcsEncoder									: Mbcs encoder (using the code page of the current locale)
	MbcsDecoder									: Mbcs decoder (using the code page of the current locale)
	Utf16Encoder								: UTF-16 encoder
	Utf16Decoder								: UTF-16 decoder
	Utf16BEEncoder								: UTF-16 encoder with big endian
	Utf16BEDecoder								: UTF-16 decoder with big endian
	Utf8Encoder									: UTF-8 encoder
	Utf8Decoder									: UTF-8 decoder
	BomEncoder									: Character encoder which writes a BOM before the text
	BomDecoder									: Character decoder which reads a BOM from the data to know the encoding
***********************************************************************/</div>

<div class="disabled">#ifndef VCZH_STREAM_CHARFORMAT</div>
<div class="disabled">#define VCZH_STREAM_CHARFORMAT</div>


<div class="disabled">namespace vl</div>
<div class="disabled">{</div>
<div class="disabled">	namespace stream</div>
<div class="disabled">	{</div>

<div class="disabled">		/*</div>
<div class="disabled">		How UCS-4 translate to UTF-8</div>
<div class="disabled">		U-00000000 - U-0000007F:  0xxxxxxx</div>
<div class="disabled">		U-00000080 - U-000007FF:  110xxxxx 10xxxxxx</div>
<div class="disabled">		U-00000800 - U-0000FFFF:  1110xxxx 10xxxxxx 10xxxxxx</div>
<div class="disabled">		U-00010000 - U-001FFFFF:  11110xxx 10xxxxxx 10xxxxxx 10xxxxxx</div>
<div class="disabled">		U-00200000 - U-03FFFFFF:  111110xx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx</div>
<div class="disabled">		U-04000000 - U-7FFFFFFF:  1111110x 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx</div>
<div class="disabled">		BOM:</div>
<div class="disabled">		FFFE	=Unicode			(vceUtf16)</div>
<div class="disabled">		FEFF	=Unicode Big Endian	(vceUtf16_be)</div>
<div class="disabled">		EFBBBF	=UTF-8				(vceUtf8)</div>
<div class="disabled">		other	=MBCS(GBK)			(vceMbcs)</div>
<div class="disabled">		*/</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Char Encoder and Decoder</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">		/// &lt;summary&gt;Base type of all character encoder.&lt;/summary&gt;</div>
<div class="disabled">		class CharEncoder : public Object, public IEncoder</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			IStream*						stream;</div>
<div class="disabled">			vuint8_t						cacheBuffer[sizeof(wchar_t)];</div>
<div class="disabled">			vint							cacheSize;</div>

<div class="disabled">			virtual vint					WriteString(wchar_t* _buffer, vint chars)=0;</div>
<div class="disabled">		public:</div>
<div class="disabled">			CharEncoder();</div>

<div class="disabled">			void							Setup(IStream* _stream);</div>
<div class="disabled">			void							Close();</div>
<div class="disabled">			vint							Write(void* _buffer, vint _size);</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Base type of all character decoder.&lt;/summary&gt;</div>
<div class="disabled">		class CharDecoder : public Object, public IDecoder</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			IStream*						stream;</div>
<div class="disabled">			vuint8_t						cacheBuffer[sizeof(wchar_t)];</div>
<div class="disabled">			vint							cacheSize;</div>

<div class="disabled">			virtual vint					ReadString(wchar_t* _buffer, vint chars)=0;</div>
<div class="disabled">		public:</div>
<div class="disabled">			CharDecoder();</div>

<div class="disabled">			void							Setup(IStream* _stream);</div>
<div class="disabled">			void							Close();</div>
<div class="disabled">			vint							Read(void* _buffer, vint _size);</div>
<div class="disabled">		};</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Mbcs</div>
<div class="disabled">***********************************************************************/</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Encoder to transform text in a local code page from wchar_t.&lt;/summary&gt;</div>
<div class="disabled">		class MbcsEncoder : public CharEncoder</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			vint							WriteString(wchar_t* _buffer, vint chars);</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Encoder to transform text in a local code page to wchar_t.&lt;/summary&gt;</div>
<div class="disabled">		class MbcsDecoder : public CharDecoder</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			vint							ReadString(wchar_t* _buffer, vint chars);</div>
<div class="disabled">		};</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Utf-16</div>
<div class="disabled">***********************************************************************/</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Encoder to transform UTF-16 text from wchar_t.&lt;/summary&gt;</div>
<div class="disabled">		class Utf16Encoder : public CharEncoder</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			vint							WriteString(wchar_t* _buffer, vint chars);</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Decoder to transform UTF-16 text to wchar_t.&lt;/summary&gt;</div>
<div class="disabled">		class Utf16Decoder : public CharDecoder</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			vint							ReadString(wchar_t* _buffer, vint chars);</div>
<div class="disabled">		};</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Utf-16-be</div>
<div class="disabled">***********************************************************************/</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Encoder to transform big endian UTF-16 text from wchar_t.&lt;/summary&gt;</div>
<div class="disabled">		class Utf16BEEncoder : public CharEncoder</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			vint							WriteString(wchar_t* _buffer, vint chars);</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Decoder to transform big endian UTF-16 text to wchar_t.&lt;/summary&gt;</div>
<div class="disabled">		class Utf16BEDecoder : public CharDecoder</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			vint							ReadString(wchar_t* _buffer, vint chars);</div>
<div class="disabled">		};</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Utf-8</div>
<div class="disabled">***********************************************************************/</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Encoder to transform UTF-8 text from wchar_t.&lt;/summary&gt;</div>
<div class="disabled">		class Utf8Encoder : public CharEncoder</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			vint							WriteString(wchar_t* _buffer, vint chars);</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Decoder to transform UTF-8 text to wchar_t.&lt;/summary&gt;</div>
<div class="disabled">		class Utf8Decoder : public CharDecoder</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">#if defined VCZH_MSVC</div>
<div class="disabled">			wchar_t							cache;</div>
<div class="disabled">			bool							cacheAvailable;</div>
<div class="disabled">#endif</div>
<div class="disabled">			vint							ReadString(wchar_t* _buffer, vint chars);</div>
<div class="disabled">		public:</div>
<div class="disabled">			Utf8Decoder();</div>
<div class="disabled">		};</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Bom</div>
<div class="disabled">***********************************************************************/</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Encoder to transform text from wchar_t. A BOM will be added at the beginning.&lt;/summary&gt;</div>
<div class="disabled">		class BomEncoder : public Object, public IEncoder</div>
<div class="disabled">		{</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Text encoding.&lt;/summary&gt;</div>
<div class="disabled">			enum Encoding</div>
<div class="disabled">			{</div>
<div class="disabled">				/// &lt;summary&gt;Multi-bytes character string.&lt;/summary&gt;</div>
<div class="disabled">				Mbcs,</div>
<div class="disabled">				/// &lt;summary&gt;UTF-8.&lt;/summary&gt;</div>
<div class="disabled">				Utf8,</div>
<div class="disabled">				/// &lt;summary&gt;UTF-16.&lt;/summary&gt;</div>
<div class="disabled">				Utf16,</div>
<div class="disabled">				/// &lt;summary&gt;Big endian UTF-16.&lt;/summary&gt;</div>
<div class="disabled">				Utf16BE</div>
<div class="disabled">			};</div>
<div class="disabled">		protected:</div>
<div class="disabled">			Encoding						encoding;</div>
<div class="disabled">			IEncoder*						encoder;</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create an encoder.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_encoding&quot;&gt;Specified encoding.&lt;/param&gt;</div>
<div class="disabled">			BomEncoder(Encoding _encoding);</div>
<div class="disabled">			~BomEncoder();</div>

<div class="disabled">			void							Setup(IStream* _stream);</div>
<div class="disabled">			void							Close();</div>
<div class="disabled">			vint							Write(void* _buffer, vint _size);</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Decoder to transform text to wchar_t. This decoder depends on the BOM information at the beginning to decide the format of the input.&lt;/summary&gt;</div>
<div class="disabled">		class BomDecoder : public Object, public IDecoder</div>
<div class="disabled">		{</div>
<div class="disabled">		private:</div>
<div class="disabled">			class BomStream : public Object, public IStream</div>
<div class="disabled">			{</div>
<div class="disabled">			protected:</div>
<div class="disabled">				IStream*					stream;</div>
<div class="disabled">				char						bom[3];</div>
<div class="disabled">				vint						bomLength;</div>
<div class="disabled">				vint						bomPosition;</div>
<div class="disabled">			public:</div>
<div class="disabled">				BomStream(IStream* _stream, char* _bom, vint _bomLength);</div>

<div class="disabled">				bool						CanRead()const;</div>
<div class="disabled">				bool						CanWrite()const;</div>
<div class="disabled">				bool						CanSeek()const;</div>
<div class="disabled">				bool						CanPeek()const;</div>
<div class="disabled">				bool						IsLimited()const;</div>
<div class="disabled">				bool						IsAvailable()const;</div>
<div class="disabled">				void						Close();</div>
<div class="disabled">				pos_t						Position()const;</div>
<div class="disabled">				pos_t						Size()const;</div>
<div class="disabled">				void						Seek(pos_t _size);</div>
<div class="disabled">				void						SeekFromBegin(pos_t _size);</div>
<div class="disabled">				void						SeekFromEnd(pos_t _size);</div>
<div class="disabled">				vint						Read(void* _buffer, vint _size);</div>
<div class="disabled">				vint						Write(void* _buffer, vint _size);</div>
<div class="disabled">				vint						Peek(void* _buffer, vint _size);</div>
<div class="disabled">			};</div>
<div class="disabled">		protected:</div>
<div class="disabled">			IDecoder*						decoder;</div>
<div class="disabled">			IStream*						stream;</div>

<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create an decoder.&lt;/summary&gt;</div>
<div class="disabled">			BomDecoder();</div>
<div class="disabled">			~BomDecoder();</div>

<div class="disabled">			void							Setup(IStream* _stream);</div>
<div class="disabled">			void							Close();</div>
<div class="disabled">			vint							Read(void* _buffer, vint _size);</div>
<div class="disabled">		};</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Encoding Test</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">		/// &lt;summary&gt;Guess the text encoding in a buffer.&lt;/summary&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;buffer&quot;&gt;The buffer to guess.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;size&quot;&gt;Size of the buffer in bytes.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;encoding&quot;&gt;Returns the most possible encoding.&lt;/param&gt;</div>
<div class="disabled">		/// &lt;param name=&quot;containsBom&quot;&gt;Returns true if the BOM information is at the beginning of the buffer.&lt;/param&gt;</div>
<div class="disabled">		extern void							TestEncoding(unsigned char* buffer, vint size, BomEncoder::Encoding&amp; encoding, bool&amp; containsBom);</div>

<div class="disabled">/***********************************************************************</div>
<div class="disabled">Serialization</div>
<div class="disabled">***********************************************************************/</div>

<div class="disabled">		namespace internal</div>
<div class="disabled">		{</div>
<div class="disabled">			template&lt;typename T&gt;</div>
<div class="disabled">			struct Reader</div>
<div class="disabled">			{</div>
<div class="disabled">				stream::IStream&amp;			input;</div>
<div class="disabled">				T							context;</div>

<div class="disabled">				Reader(stream::IStream&amp; _input)</div>
<div class="disabled">					:input(_input)</div>
<div class="disabled">					, context(nullptr)</div>
<div class="disabled">				{</div>
<div class="disabled">				}</div>
<div class="disabled">			};</div>
<div class="disabled">				</div>
<div class="disabled">			template&lt;typename T&gt;</div>
<div class="disabled">			struct Writer</div>
<div class="disabled">			{</div>
<div class="disabled">				stream::IStream&amp;			output;</div>
<div class="disabled">				T							context;</div>

<div class="disabled">				Writer(stream::IStream&amp; _output)</div>
<div class="disabled">					:output(_output)</div>
<div class="disabled">					, context(nullptr)</div>
<div class="disabled">				{</div>
<div class="disabled">				}</div>
<div class="disabled">			};</div>

<div class="disabled">			using ContextFreeReader = Reader&lt;void*&gt;;</div>
<div class="disabled">			using ContextFreeWriter = Writer&lt;void*&gt;;</div>

<div class="disabled">			template&lt;typename T&gt;</div>
<div class="disabled">			struct Serialization</div>
<div class="disabled">			{</div>
<div class="disabled">				template&lt;typename TIO&gt;</div>
<div class="disabled">				static void IO(TIO&amp; io, T&amp; value);</div>
<div class="disabled">			};</div>

<div class="disabled">			template&lt;typename TValue, typename TContext&gt;</div>
<div class="disabled">			Reader&lt;TContext&gt;&amp; operator&lt;&lt;(Reader&lt;TContext&gt;&amp; reader, TValue&amp; value)</div>
<div class="disabled">			{</div>
<div class="disabled">				Serialization&lt;TValue&gt;::IO(reader, value);</div>
<div class="disabled">				return reader;</div>
<div class="disabled">			}</div>

<div class="disabled">			template&lt;typename TValue, typename TContext&gt;</div>
<div class="disabled">			Writer&lt;TContext&gt;&amp; operator&lt;&lt;(Writer&lt;TContext&gt;&amp; writer, TValue&amp; value)</div>
<div class="disabled">			{</div>
<div class="disabled">				Serialization&lt;TValue&gt;::IO(writer, value);</div>
<div class="disabled">				return writer;</div>
<div class="disabled">			}</div>

<div class="disabled">			//---------------------------------------------</div>

<div class="disabled">			template&lt;&gt;</div>
<div class="disabled">			struct Serialization&lt;vint64_t&gt;</div>
<div class="disabled">			{</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Reader&lt;TContext&gt;&amp; reader, vint64_t&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					if (reader.input.Read(&amp;value, sizeof(value)) != sizeof(value))</div>
<div class="disabled">					{</div>
<div class="disabled">						CHECK_FAIL(L&quot;Deserialization failed.&quot;);</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">				</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Writer&lt;TContext&gt;&amp; writer, vint64_t&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					if (writer.output.Write(&amp;value, sizeof(value)) != sizeof(value))</div>
<div class="disabled">					{</div>
<div class="disabled">						CHECK_FAIL(L&quot;Serialization failed.&quot;);</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">			};</div>

<div class="disabled">			template&lt;&gt;</div>
<div class="disabled">			struct Serialization&lt;vint32_t&gt;</div>
<div class="disabled">			{</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Reader&lt;TContext&gt;&amp; reader, vint32_t&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint64_t v = 0;</div>
<div class="disabled">					Serialization&lt;vint64_t&gt;::IO(reader, v);</div>
<div class="disabled">					value = (vint32_t)v;</div>
<div class="disabled">				}</div>
<div class="disabled">					</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Writer&lt;TContext&gt;&amp; writer, vint32_t&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint64_t v = (vint64_t)value;</div>
<div class="disabled">					Serialization&lt;vint64_t&gt;::IO(writer, v);</div>
<div class="disabled">				}</div>
<div class="disabled">			};</div>

<div class="disabled">			template&lt;&gt;</div>
<div class="disabled">			struct Serialization&lt;bool&gt;</div>
<div class="disabled">			{</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Reader&lt;TContext&gt;&amp; reader, bool&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint8_t v = 0;</div>
<div class="disabled">					if (reader.input.Read(&amp;v, sizeof(v)) != sizeof(v))</div>
<div class="disabled">					{</div>
<div class="disabled">						CHECK_FAIL(L&quot;Deserialization failed.&quot;);</div>
<div class="disabled">					}</div>
<div class="disabled">					else</div>
<div class="disabled">					{</div>
<div class="disabled">						value = v == -1;</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">					</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Writer&lt;TContext&gt;&amp; writer, bool&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint8_t v = value ? -1 : 0;</div>
<div class="disabled">					if (writer.output.Write(&amp;v, sizeof(v)) != sizeof(v))</div>
<div class="disabled">					{</div>
<div class="disabled">						CHECK_FAIL(L&quot;Serialization failed.&quot;);</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">			};</div>

<div class="disabled">			template&lt;typename T&gt;</div>
<div class="disabled">			struct Serialization&lt;Ptr&lt;T&gt;&gt;</div>
<div class="disabled">			{</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Reader&lt;TContext&gt;&amp; reader, Ptr&lt;T&gt;&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					bool notNull = false;</div>
<div class="disabled">					reader &lt;&lt; notNull;</div>
<div class="disabled">					if (notNull)</div>
<div class="disabled">					{</div>
<div class="disabled">						value = new T;</div>
<div class="disabled">						Serialization&lt;T&gt;::IO(reader, *value.Obj());</div>
<div class="disabled">					}</div>
<div class="disabled">					else</div>
<div class="disabled">					{</div>
<div class="disabled">						value = 0;</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">					</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Writer&lt;TContext&gt;&amp; writer, Ptr&lt;T&gt;&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					bool notNull = value;</div>
<div class="disabled">					writer &lt;&lt; notNull;</div>
<div class="disabled">					if (notNull)</div>
<div class="disabled">					{</div>
<div class="disabled">						Serialization&lt;T&gt;::IO(writer, *value.Obj());</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">			};</div>

<div class="disabled">			template&lt;typename T&gt;</div>
<div class="disabled">			struct Serialization&lt;Nullable&lt;T&gt;&gt;</div>
<div class="disabled">			{</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Reader&lt;TContext&gt;&amp; reader, Nullable&lt;T&gt;&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					bool notNull = false;</div>
<div class="disabled">					reader &lt;&lt; notNull;</div>
<div class="disabled">					if (notNull)</div>
<div class="disabled">					{</div>
<div class="disabled">						T data;</div>
<div class="disabled">						Serialization&lt;T&gt;::IO(reader, data);</div>
<div class="disabled">						value = Nullable&lt;T&gt;(data);</div>
<div class="disabled">					}</div>
<div class="disabled">					else</div>
<div class="disabled">					{</div>
<div class="disabled">						value = Nullable&lt;T&gt;();</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">				</div>
<div class="disabled">				template&lt;typename TContext&gt;	</div>
<div class="disabled">				static void IO(Writer&lt;TContext&gt;&amp; writer, Nullable&lt;T&gt;&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					bool notNull = value;</div>
<div class="disabled">					writer &lt;&lt; notNull;</div>
<div class="disabled">					if (notNull)</div>
<div class="disabled">					{</div>
<div class="disabled">						T data = value.Value();</div>
<div class="disabled">						Serialization&lt;T&gt;::IO(writer, data);</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">			};</div>

<div class="disabled">			template&lt;&gt;</div>
<div class="disabled">			struct Serialization&lt;WString&gt;</div>
<div class="disabled">			{</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Reader&lt;TContext&gt;&amp; reader, WString&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint count = -1;</div>
<div class="disabled">					reader &lt;&lt; count;</div>
<div class="disabled">					if (count &gt; 0)</div>
<div class="disabled">					{</div>
<div class="disabled">						MemoryStream stream;</div>
<div class="disabled">						reader &lt;&lt; (IStream&amp;)stream;</div>
<div class="disabled">						Utf8Decoder decoder;</div>
<div class="disabled">						decoder.Setup(&amp;stream);</div>

<div class="disabled">						collections::Array&lt;wchar_t&gt; stringBuffer(count + 1);</div>
<div class="disabled">						vint stringSize = decoder.Read(&amp;stringBuffer[0], count * sizeof(wchar_t));</div>
<div class="disabled">						stringBuffer[stringSize / sizeof(wchar_t)] = 0;</div>

<div class="disabled">						value = &amp;stringBuffer[0];</div>
<div class="disabled">					}</div>
<div class="disabled">					else</div>
<div class="disabled">					{</div>
<div class="disabled">						value = L&quot;&quot;;</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">					</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Writer&lt;TContext&gt;&amp; writer, WString&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint count = value.Length();</div>
<div class="disabled">					writer &lt;&lt; count;</div>
<div class="disabled">					if (count &gt; 0)</div>
<div class="disabled">					{</div>
<div class="disabled">						MemoryStream stream;</div>
<div class="disabled">						{</div>
<div class="disabled">							Utf8Encoder encoder;</div>
<div class="disabled">							encoder.Setup(&amp;stream);</div>
<div class="disabled">							encoder.Write((void*)value.Buffer(), count * sizeof(wchar_t));</div>
<div class="disabled">						}</div>
<div class="disabled">						writer &lt;&lt; (IStream&amp;)stream;</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">			};</div>

<div class="disabled">			template&lt;typename T&gt;</div>
<div class="disabled">			struct Serialization&lt;collections::List&lt;T&gt;&gt;</div>
<div class="disabled">			{</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Reader&lt;TContext&gt;&amp; reader, collections::List&lt;T&gt;&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint32_t count = -1;</div>
<div class="disabled">					reader &lt;&lt; count;</div>
<div class="disabled">					value.Clear();</div>
<div class="disabled">					for (vint i = 0; i &lt; count; i++)</div>
<div class="disabled">					{</div>
<div class="disabled">						T t;</div>
<div class="disabled">						reader &lt;&lt; t;</div>
<div class="disabled">						value.Add(t);</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">					</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Writer&lt;TContext&gt;&amp; writer, collections::List&lt;T&gt;&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint32_t count = (vint32_t)value.Count();</div>
<div class="disabled">					writer &lt;&lt; count;</div>
<div class="disabled">					for (vint i = 0; i &lt; count; i++)</div>
<div class="disabled">					{</div>
<div class="disabled">						writer &lt;&lt; value[i];</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">			};</div>

<div class="disabled">			template&lt;typename T&gt;</div>
<div class="disabled">			struct Serialization&lt;collections::Array&lt;T&gt;&gt;</div>
<div class="disabled">			{</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Reader&lt;TContext&gt;&amp; reader, collections::Array&lt;T&gt;&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint32_t count = -1;</div>
<div class="disabled">					reader &lt;&lt; count;</div>
<div class="disabled">					value.Resize(count);</div>
<div class="disabled">					for (vint i = 0; i &lt; count; i++)</div>
<div class="disabled">					{</div>
<div class="disabled">						reader &lt;&lt; value[i];</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">					</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Writer&lt;TContext&gt;&amp; writer, collections::Array&lt;T&gt;&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint32_t count = (vint32_t)value.Count();</div>
<div class="disabled">					writer &lt;&lt; count;</div>
<div class="disabled">					for (vint i = 0; i &lt; count; i++)</div>
<div class="disabled">					{</div>
<div class="disabled">						writer &lt;&lt; value[i];</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">			};</div>

<div class="disabled">			template&lt;typename K, typename V&gt;</div>
<div class="disabled">			struct Serialization&lt;collections::Dictionary&lt;K, V&gt;&gt;</div>
<div class="disabled">			{</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Reader&lt;TContext&gt;&amp; reader, collections::Dictionary&lt;K, V&gt;&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint32_t count = -1;</div>
<div class="disabled">					reader &lt;&lt; count;</div>
<div class="disabled">					value.Clear();</div>
<div class="disabled">					for (vint i = 0; i &lt; count; i++)</div>
<div class="disabled">					{</div>
<div class="disabled">						K k;</div>
<div class="disabled">						V v;</div>
<div class="disabled">						reader &lt;&lt; k &lt;&lt; v;</div>
<div class="disabled">						value.Add(k, v);</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">					</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Writer&lt;TContext&gt;&amp; writer, collections::Dictionary&lt;K, V&gt;&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint32_t count = (vint32_t)value.Count();</div>
<div class="disabled">					writer &lt;&lt; count;</div>
<div class="disabled">					for (vint i = 0; i &lt; count; i++)</div>
<div class="disabled">					{</div>
<div class="disabled">						K k = value.Keys()[i];</div>
<div class="disabled">						V v = value.Values()[i];</div>
<div class="disabled">						writer &lt;&lt; k &lt;&lt; v;</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">			};</div>

<div class="disabled">			template&lt;typename K, typename V&gt;</div>
<div class="disabled">			struct Serialization&lt;collections::Group&lt;K, V&gt;&gt;</div>
<div class="disabled">			{</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Reader&lt;TContext&gt;&amp; reader, collections::Group&lt;K, V&gt;&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint32_t count = -1;</div>
<div class="disabled">					reader &lt;&lt; count;</div>
<div class="disabled">					value.Clear();</div>
<div class="disabled">					for (vint i = 0; i &lt; count; i++)</div>
<div class="disabled">					{</div>
<div class="disabled">						K k;</div>
<div class="disabled">						collections::List&lt;V&gt; v;</div>
<div class="disabled">						reader &lt;&lt; k &lt;&lt; v;</div>
<div class="disabled">						for (vint j = 0; j &lt; v.Count(); j++)</div>
<div class="disabled">						{</div>
<div class="disabled">							value.Add(k, v[j]);</div>
<div class="disabled">						}</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">					</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Writer&lt;TContext&gt;&amp; writer, collections::Group&lt;K, V&gt;&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint32_t count = (vint32_t)value.Count();</div>
<div class="disabled">					writer &lt;&lt; count;</div>
<div class="disabled">					for (vint i = 0; i &lt; count; i++)</div>
<div class="disabled">					{</div>
<div class="disabled">						K k = value.Keys()[i];</div>
<div class="disabled">						collections::List&lt;V&gt;&amp; v = const_cast&lt;collections::List&lt;V&gt;&amp;&gt;(value.GetByIndex(i));</div>
<div class="disabled">						writer &lt;&lt; k &lt;&lt; v;</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">			};</div>

<div class="disabled">			template&lt;&gt;</div>
<div class="disabled">			struct Serialization&lt;stream::IStream&gt;</div>
<div class="disabled">			{</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Reader&lt;TContext&gt;&amp; reader, stream::IStream&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint32_t count = 0;</div>
<div class="disabled">					reader.input.Read(&amp;count, sizeof(count));</div>

<div class="disabled">					if (count &gt; 0)</div>
<div class="disabled">					{</div>
<div class="disabled">						vint length = 0;</div>
<div class="disabled">						collections::Array&lt;vuint8_t&gt; buffer(count);</div>
<div class="disabled">						value.SeekFromBegin(0);</div>
<div class="disabled">						length = reader.input.Read(&amp;buffer[0], count);</div>
<div class="disabled">						if (length != count)</div>
<div class="disabled">						{</div>
<div class="disabled">							CHECK_FAIL(L&quot;Deserialization failed.&quot;);</div>
<div class="disabled">						}</div>
<div class="disabled">						length = value.Write(&amp;buffer[0], count);</div>
<div class="disabled">						if (length != count)</div>
<div class="disabled">						{</div>
<div class="disabled">							CHECK_FAIL(L&quot;Deserialization failed.&quot;);</div>
<div class="disabled">						}</div>
<div class="disabled">						value.SeekFromBegin(0);</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">					</div>
<div class="disabled">				template&lt;typename TContext&gt;</div>
<div class="disabled">				static void IO(Writer&lt;TContext&gt;&amp; writer, stream::IStream&amp; value)</div>
<div class="disabled">				{</div>
<div class="disabled">					vint32_t count = (vint32_t)value.Size();</div>
<div class="disabled">					writer.output.Write(&amp;count, sizeof(count));</div>

<div class="disabled">					if (count &gt; 0)</div>
<div class="disabled">					{</div>
<div class="disabled">						vint length = 0;</div>
<div class="disabled">						collections::Array&lt;vuint8_t&gt; buffer(count);</div>
<div class="disabled">						value.SeekFromBegin(0);</div>
<div class="disabled">						length = value.Read(&amp;buffer[0], count);</div>
<div class="disabled">						if (length != count)</div>
<div class="disabled">						{</div>
<div class="disabled">							CHECK_FAIL(L&quot;Serialization failed.&quot;);</div>
<div class="disabled">						}</div>
<div class="disabled">						length = writer.output.Write(&amp;buffer[0], count);</div>
<div class="disabled">						if (length != count)</div>
<div class="disabled">						{</div>
<div class="disabled">							CHECK_FAIL(L&quot;Serialization failed.&quot;);</div>
<div class="disabled">						}</div>
<div class="disabled">						value.SeekFromBegin(0);</div>
<div class="disabled">					}</div>
<div class="disabled">				}</div>
<div class="disabled">			};</div>

<div class="disabled">			//---------------------------------------------</div>

<div class="disabled">#define BEGIN_SERIALIZATION(TYPE)\</div>
<div class="disabled">				template&lt;&gt;\</div>
<div class="disabled">				struct Serialization&lt;TYPE&gt;\</div>
<div class="disabled">				{\</div>
<div class="disabled">					template&lt;typename TIO&gt;\</div>
<div class="disabled">					static void IO(TIO&amp; op, TYPE&amp; value)\</div>
<div class="disabled">					{\</div>
<div class="disabled">						op\</div>

<div class="disabled">#define SERIALIZE(FIELD)\</div>
<div class="disabled">						&lt;&lt; value.FIELD\</div>

<div class="disabled">#define END_SERIALIZATION\</div>
<div class="disabled">						;\</div>
<div class="disabled">					}\</div>
<div class="disabled">				};\</div>

<div class="disabled">#define SERIALIZE_ENUM(TYPE)\</div>
<div class="disabled">			template&lt;&gt;\</div>
<div class="disabled">			struct Serialization&lt;TYPE&gt;\</div>
<div class="disabled">			{\</div>
<div class="disabled">				template&lt;typename TContext&gt;\</div>
<div class="disabled">				static void IO(Reader&lt;TContext&gt;&amp; reader, TYPE&amp; value)\</div>
<div class="disabled">				{\</div>
<div class="disabled">					vint32_t v = 0;\</div>
<div class="disabled">					Serialization&lt;vint32_t&gt;::IO(reader, v);\</div>
<div class="disabled">					value = (TYPE)v;\</div>
<div class="disabled">				}\</div>
<div class="disabled">				template&lt;typename TContext&gt;\</div>
<div class="disabled">				static void IO(Writer&lt;TContext&gt;&amp; writer, TYPE&amp; value)\</div>
<div class="disabled">				{\</div>
<div class="disabled">					vint32_t v = (vint32_t)value;\</div>
<div class="disabled">					Serialization&lt;vint32_t&gt;::IO(writer, v);\</div>
<div class="disabled">				}\</div>
<div class="disabled">			};\</div>

<div class="disabled">		}</div>
<div class="disabled">	}</div>
<div class="disabled">}</div>

<div class="disabled">#endif</div>


<div class="token cpp_comment ">/***********************************************************************
.\FILESYSTEM.H
***********************************************************************/</div>
<div class="token cpp_comment ">/***********************************************************************
Vczh Library++ 3.0
Developer: Zihan Chen(vczh)
Framework::FileSystem

***********************************************************************/</div>

<div class="disabled">#ifndef VCZH_FILESYSTEM</div>
<div class="disabled">#define VCZH_FILESYSTEM</div>


<div class="disabled">namespace vl</div>
<div class="disabled">{</div>
<div class="disabled">	namespace filesystem</div>
<div class="disabled">	{</div>
<div class="disabled">		/// &lt;summary&gt;A type representing a file path.&lt;/summary&gt;</div>
<div class="disabled">		class FilePath : public Object</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			WString						fullPath;</div>

<div class="disabled">			void						Initialize();</div>

<div class="disabled">			static void					GetPathComponents(WString path, collections::List&lt;WString&gt;&amp; components);</div>
<div class="disabled">			static WString				ComponentsToPath(const collections::List&lt;WString&gt;&amp; components);</div>
<div class="disabled">		public:</div>
<div class="disabled">#if defined VCZH_MSVC</div>
<div class="disabled">			static const wchar_t		Delimiter = L&apos;\\&apos;;</div>
<div class="disabled">#elif defined VCZH_GCC</div>
<div class="disabled">			static const wchar_t		Delimiter = L&apos;/&apos;;</div>
<div class="disabled">#endif</div>

<div class="disabled">			/// &lt;summary&gt;Create a root path.&lt;/summary&gt;</div>
<div class="disabled">			FilePath();</div>
<div class="disabled">			/// &lt;summary&gt;Create a file path.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_filePath&quot;&gt;Content of the file path. If it is a relative path, it will be converted to an absolute path.&lt;/param&gt;</div>
<div class="disabled">			FilePath(const WString&amp; _filePath);</div>
<div class="disabled">			/// &lt;summary&gt;Create a file path.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_filePath&quot;&gt;Content of the file path. If it is a relative path, it will be converted to an absolute path.&lt;/param&gt;</div>
<div class="disabled">			FilePath(const wchar_t* _filePath);</div>
<div class="disabled">			/// &lt;summary&gt;Copy a file path.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_filePath&quot;&gt;The file path to copy.&lt;/param&gt;</div>
<div class="disabled">			FilePath(const FilePath&amp; _filePath);</div>
<div class="disabled">			~FilePath();</div>

<div class="disabled">			static vint					Compare(const FilePath&amp; a, const FilePath&amp; b);</div>
<div class="disabled">			bool						operator==(const FilePath&amp; filePath)const{ return Compare(*this, filePath) == 0; }</div>
<div class="disabled">			bool						operator!=(const FilePath&amp; filePath)const{ return Compare(*this, filePath) != 0; }</div>
<div class="disabled">			bool						operator&lt; (const FilePath&amp; filePath)const{ return Compare(*this, filePath) &lt;  0; }</div>
<div class="disabled">			bool						operator&lt;=(const FilePath&amp; filePath)const{ return Compare(*this, filePath) &lt;= 0; }</div>
<div class="disabled">			bool						operator&gt; (const FilePath&amp; filePath)const{ return Compare(*this, filePath) &gt;  0; }</div>
<div class="disabled">			bool						operator&gt;=(const FilePath&amp; filePath)const{ return Compare(*this, filePath) &gt;= 0; }</div>

<div class="disabled">			/// &lt;summary&gt;Concat an absolute path and a relative path.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The result absolute path.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;relativePath&quot;&gt;The relative path to concat.&lt;/param&gt;</div>
<div class="disabled">			FilePath					operator/(const WString&amp; relativePath)const;</div>

<div class="disabled">			/// &lt;summary&gt;Test if the file path is a file.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if the file path is a file.&lt;/returns&gt;</div>
<div class="disabled">			bool						IsFile()const;</div>
<div class="disabled">			/// &lt;summary&gt;Test if the file path is a folder.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if the file path is a folder.&lt;/returns&gt;</div>
<div class="disabled">			bool						IsFolder()const;</div>
<div class="disabled">			/// &lt;summary&gt;Test if the file path is a the root of all file system objects.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if the file path is the root of all file system objects.&lt;/returns&gt;</div>
<div class="disabled">			bool						IsRoot()const;</div>

<div class="disabled">			/// &lt;summary&gt;Get the last piece of names in the file path.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The last piece of names in the file path.&lt;/returns&gt;</div>
<div class="disabled">			WString						GetName()const;</div>
<div class="disabled">			/// &lt;summary&gt;Get the containing folder of this file path.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The containing folder.&lt;/returns&gt;</div>
<div class="disabled">			FilePath					GetFolder()const;</div>
<div class="disabled">			/// &lt;summary&gt;Get the content of the file path.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The content of the file path.&lt;/returns&gt;</div>
<div class="disabled">			WString						GetFullPath()const;</div>
<div class="disabled">			/// &lt;summary&gt;Calculate the relative path using a referencing folder.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The relative path.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_filePath&quot;&gt;The referencing folder.&lt;/param&gt;</div>
<div class="disabled">			WString						GetRelativePathFor(const FilePath&amp; _filePath);</div>

<div class="disabled">		};</div>

<div class="disabled">		/// &lt;summary&gt;Representing a file reference.&lt;/summary&gt;</div>
<div class="disabled">		class File : public Object</div>
<div class="disabled">		{</div>
<div class="disabled">		private:</div>
<div class="disabled">			FilePath					filePath;</div>

<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create an empty reference.&lt;/summary&gt;</div>
<div class="disabled">			File();</div>
<div class="disabled">			/// &lt;summary&gt;Create a reference to a specified file.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_filePath&quot;&gt;The specified file.&lt;/param&gt;</div>
<div class="disabled">			File(const FilePath&amp; _filePath);</div>
<div class="disabled">			~File();</div>

<div class="disabled">			/// &lt;summary&gt;Get the file path of the file.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The file path.&lt;/returns&gt;</div>
<div class="disabled">			const FilePath&amp;				GetFilePath()const;</div>

<div class="disabled">			/// &lt;summary&gt;Get the content of the file as text with encoding testing.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns false if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;text&quot;&gt;The content of the file.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;encoding&quot;&gt;The encoding.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;containsBom&quot;&gt;True if there is BOM.&lt;/param&gt;</div>
<div class="disabled">			bool						ReadAllTextWithEncodingTesting(WString&amp; text, stream::BomEncoder::Encoding&amp; encoding, bool&amp; containsBom);</div>
<div class="disabled">			/// &lt;summary&gt;Get the content of the file as text.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The content of the file.&lt;/returns&gt;</div>
<div class="disabled">			WString						ReadAllTextByBom()const;</div>
<div class="disabled">			/// &lt;summary&gt;Get the content of the file as text.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns false if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;text&quot;&gt;The content of the file.&lt;/param&gt;</div>
<div class="disabled">			bool						ReadAllTextByBom(WString&amp; text)const;</div>
<div class="disabled">			/// &lt;summary&gt;Get the content of the file as text.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns false if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;lines&quot;&gt;The content of the file.&lt;/param&gt;</div>
<div class="disabled">			bool						ReadAllLinesByBom(collections::List&lt;WString&gt;&amp; lines)const;</div>

<div class="disabled">			/// &lt;summary&gt;Write text to the file.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns false if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;text&quot;&gt;The text to write.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;bom&quot;&gt;Set to true to add a corresponding BOM at the beginning of the file according to the encoding.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;encoding&quot;&gt;The text encoding.&lt;/param&gt;</div>
<div class="disabled">			bool						WriteAllText(const WString&amp; text, bool bom = true, stream::BomEncoder::Encoding encoding = stream::BomEncoder::Utf16);</div>
<div class="disabled">			/// &lt;summary&gt;Write text to the file.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns false if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;lines&quot;&gt;The text to write.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;bom&quot;&gt;Set to true to add a corresponding BOM at the beginning of the file according to the encoding.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;encoding&quot;&gt;The text encoding.&lt;/param&gt;</div>
<div class="disabled">			bool						WriteAllLines(collections::List&lt;WString&gt;&amp; lines, bool bom = true, stream::BomEncoder::Encoding encoding = stream::BomEncoder::Utf16);</div>
<div class="disabled">			</div>
<div class="disabled">			/// &lt;summary&gt;Test does the file exist or not.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if the file exists.&lt;/returns&gt;</div>
<div class="disabled">			bool						Exists()const;</div>
<div class="disabled">			/// &lt;summary&gt;Delete the file.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">			bool						Delete()const;</div>
<div class="disabled">			/// &lt;summary&gt;Rename the file in the same folder.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;newName&quot;&gt;The new file name.&lt;/param&gt;</div>
<div class="disabled">			bool						Rename(const WString&amp; newName)const;</div>
<div class="disabled">		};</div>
<div class="disabled">		</div>
<div class="disabled">		/// &lt;summary&gt;Representing a folder reference.&lt;/summary&gt;</div>
<div class="disabled">		class Folder : public Object</div>
<div class="disabled">		{</div>
<div class="disabled">		private:</div>
<div class="disabled">			FilePath					filePath;</div>

<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create a root reference.&lt;/summary&gt;</div>
<div class="disabled">			Folder();</div>
<div class="disabled">			/// &lt;summary&gt;Create a reference to a specified folder.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_filePath&quot;&gt;The specified folder.&lt;/param&gt;</div>
<div class="disabled">			Folder(const FilePath&amp; _filePath);</div>
<div class="disabled">			~Folder();</div>
<div class="disabled">			</div>
<div class="disabled">			/// &lt;summary&gt;Get the file path of the folder.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;The file path.&lt;/returns&gt;</div>
<div class="disabled">			const FilePath&amp;				GetFilePath()const;</div>
<div class="disabled">			/// &lt;summary&gt;Get all folders in this folder.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;folders&quot;&gt;All folders.&lt;/param&gt;</div>
<div class="disabled">			bool						GetFolders(collections::List&lt;Folder&gt;&amp; folders)const;</div>
<div class="disabled">			/// &lt;summary&gt;Get all files in this folder.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;files&quot;&gt;All files.&lt;/param&gt;</div>
<div class="disabled">			bool						GetFiles(collections::List&lt;File&gt;&amp; files)const;</div>
<div class="disabled">			</div>
<div class="disabled">			/// &lt;summary&gt;Test does the folder exist or not.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if the folder exists.&lt;/returns&gt;</div>
<div class="disabled">			bool						Exists()const;</div>
<div class="disabled">			/// &lt;summary&gt;Create the folder.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;recursively&quot;&gt;Set to true to create all parent folders if necessary.&lt;/param&gt;</div>
<div class="disabled">			bool						Create(bool recursively)const;</div>
<div class="disabled">			/// &lt;summary&gt;Delete the folder.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;recursively&quot;&gt;Set to true to delete everything in the folder.&lt;/param&gt;</div>
<div class="disabled">			bool						Delete(bool recursively)const;</div>
<div class="disabled">			/// &lt;summary&gt;Rename the folder in the same folder.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;returns&gt;Returns true if this operation succeeded.&lt;/returns&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;newName&quot;&gt;The new folder name.&lt;/param&gt;</div>
<div class="disabled">			bool						Rename(const WString&amp; newName)const;</div>
<div class="disabled">		};</div>
<div class="disabled">	}</div>
<div class="disabled">}</div>

<div class="disabled">#endif</div>


<div class="token cpp_comment ">/***********************************************************************
.\STREAM\RECORDERSTREAM.H
***********************************************************************/</div>
<div class="token cpp_comment ">/***********************************************************************
Vczh Library++ 3.0
Developer: Zihan Chen(vczh)
Stream::RecorderStream

Interfaces:
	RecorderStream					: A readable stream that will copy the data to another stream on the fly
***********************************************************************/</div>

<div class="disabled">#ifndef VCZH_STREAM_RECORDERSTREAM</div>
<div class="disabled">#define VCZH_STREAM_RECORDERSTREAM</div>


<div class="disabled">namespace vl</div>
<div class="disabled">{</div>
<div class="disabled">	namespace stream</div>
<div class="disabled">	{</div>
<div class="disabled">		/// &lt;summary&gt;A readable stream that, read from an stream, and write everything that is read to another stream.&lt;/summary&gt;</div>
<div class="disabled">		class RecorderStream : public Object, public virtual IStream</div>
<div class="disabled">		{</div>
<div class="disabled">		protected:</div>
<div class="disabled">			IStream*				in;</div>
<div class="disabled">			IStream*				out;</div>
<div class="disabled">		public:</div>
<div class="disabled">			/// &lt;summary&gt;Create a stream.&lt;/summary&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_in&quot;&gt;The stream to read.&lt;/param&gt;</div>
<div class="disabled">			/// &lt;param name=&quot;_out&quot;&gt;The stream to write what is read from &quot;_in&quot;.&lt;/param&gt;</div>
<div class="disabled">			RecorderStream(IStream&amp; _in, IStream&amp; _out);</div>
<div class="disabled">			~RecorderStream();</div>

<div class="disabled">			bool					CanRead()const;</div>
<div class="disabled">			bool					CanWrite()const;</div>
<div class="disabled">			bool					CanSeek()const;</div>
<div class="disabled">			bool					CanPeek()const;</div>
<div class="disabled">			bool					IsLimited()const;</div>
<div class="disabled">			bool					IsAvailable()const;</div>
<div class="disabled">			void					Close();</div>
<div class="disabled">			pos_t					Position()const;</div>
<div class="disabled">			pos_t					Size()const;</div>
<div class="disabled">			void					Seek(pos_t _size);</div>
<div class="disabled">			void					SeekFromBegin(pos_t _size);</div>
<div class="disabled">			void					SeekFromEnd(pos_t _size);</div>
<div class="disabled">			vint					Read(void* _buffer, vint _size);</div>
<div class="disabled">			vint					Write(void* _buffer, vint _size);</div>
<div class="disabled">			vint					Peek(void* _buffer, vint _size);</div>
<div class="disabled">		};</div>
<div class="disabled">	}</div>
<div class="disabled">}</div>

<div class="disabled">#endif
</div>
</div></div>
<script type="text/javascript">
referencedSymbols = {
};
symbolToFiles = {

};
turnOnSymbol();
</script>
</body>
</html>
